Deep Supervised Cross-modal Retrieval

Liangli Zhen‚àó
Dezhong Peng‚Ä†
Machine Intelligence Laboratory, College of Computer Science

Peng Hu‚àó

Xu Wang

Sichuan University, Chengdu, 610065, China

llzhen@outlook.com, {penghu.ml, wangxu.scu}@gmail.com, pengdz@scu.edu.cn

Abstract

Cross-modal retrieval aims to enable Ô¨Çexible retrieval
across different modalities. The core of cross-modal re-
trieval is how to measure the content similarity between
different types of data.
In this paper, we present a nov-
el cross-modal retrieval method, called Deep Supervised
Cross-modal Retrieval (DSCMR). It aims to Ô¨Ånd a common
representation space, in which the samples from different
modalities can be compared directly. SpeciÔ¨Åcally, DSCM-
R minimises the discrimination loss in both the label space
and the common representation space to supervise the mod-
el learning discriminative features. Furthermore, it simul-
taneously minimises the modality invariance loss and uses
a weight sharing strategy to eliminate the cross-modal dis-
crepancy of multimedia data in the common representation
space to learn modality-invariant features. Comprehen-
sive experimental results on four widely-used benchmark
datasets demonstrate that the proposed method is effective
in cross-modal learning and signiÔ¨Åcantly outperforms the
state-of-the-art cross-modal retrieval methods.

1. Introduction

Cross-modal retrieval aims to enable Ô¨Çexible retrieval
across different modalities (e.g., texts vs. images) [30]. It
takes one type of data as the query to retrieve relevant data
of another type. The provided search results across various
modalities can be helpful to the users to obtain comprehen-
sive information about the target events or topics. With the
rapid growth of different types of media data such as texts,
images, and videos on the Internet, cross-modal retrieval
becomes increasingly important in real-world application-
s [32]. Recently, cross-modal retrieval has attracted the con-
siderable attention of the researchers from both academia
and industry. The challenge of cross-modal retrieval is how
to measure the content similarity between different types of

‚àóFirst two authors contributed equally to this work.
‚Ä†D. Peng is the corresponding author.

data since they , which is referred to as the heterogeneity
gap [32].

A common approach to bridge the heterogeneity gap is
representation learning. It tries to Ô¨Ånd a function to transfor-
m the data samples from different modalities into a common
representation space in which the similarity between them
can be measured directly. A variety of cross-modal retrieval
methods [20] have been developed, which propose different
learning ways for Ô¨Ånding the common space. The tradition-
al ones use the statistical correlation analysis to learn linear
projections by optimising target statistical values. For ex-
[8] is one
ample, Canonical Correlation Analysis (CCA)
of the most representative works, which learns the common
space by maximising the pairwise correlations between t-
wo sets of heterogeneous data. However, the correlation
of multimedia data in the real world is too complex to be
fully modelled only by applying linear projections. Then,
some kernel-based methods [1, 34] have been developed to
address this issue, but how to select a suitable kernel func-
tion for particular cross-modal learning application is still
an unsolved problem.

Inspired by the great success of deep neural network-
s in representation learning [14], a large number of deep
learning-based approaches [2, 33, 19, 36, 21, 25, 7] have
been proposed to learn a common presentation space for
multimedia data. For instance, Ngiam et al. [18] propose
a bimodal deep auto-encoder to learn the cross-modal cor-
relation as well as preserve the reconstruction information
and apply a Restricted Boltzmann Machine (RBM) to learn
the common space for cross-modal retrieval. Different from
[18], which learns common representations in an unsuper-
vised way, some supervised deep cross-modal learning ap-
proaches have been proposed to learn more discriminative
representations. They are potentially able to provide a much
better separation between classes in the common represen-
tation space. In this class of methods, Jiang et al. [9] pro-
pose to use the label information to learn the discriminative
information between samples from inter-modalities. In ad-
dition, the cross-modal similarity is preserved by enforcing
the representations of each image-text pair to be close to

110394

each other in a common Hamming space. In [35], Wang et
al. propose a Multi-modal Deep Neural Network (MDNN)
based on a deep Convolutional Neural Network (CNN) and
a Neural Language Model (NLM) to learn mapping func-
tions for the image modality and the text modality, respec-
tively. The (labels of the samples) classiÔ¨Åcation information
is used to learn intra-modal semantics for image and text.
The Euclidean distance is used to measure the difference be-
tween the representations for an image-text pair to guide the
cross-modal learning. In [30], the classiÔ¨Åcation information
is also used to learn intra-modal discrimination in data dur-
ing the feature projection. It is notable that even though the
classiÔ¨Åcation information has been used in these approach-
es, the classiÔ¨Åcation information is only used to learn dis-
criminative features within each modality or between inter-
modalities. The semantic information is not fully exploited
in these cross-modal learning approaches.

In this paper, we present a novel cross-modal retrieval
method, called Deep Supervised Cross-modal Retrieval (D-
SCMR). It aims to preserve the discrimination among the
samples from different semantic categories and eliminate
the cross-modal discrepancy as well. To achieve this goal,
it minimises the discrimination loss of the samples both in
the label space and the common representation space to su-
pervise our model learning discriminative features. Further-
more, it simultaneously minimises the modality invariance
loss and uses a weight sharing strategy to learn modality-
invariant features in the common representation space. Fol-
lowing this learning strategy, both the pairwise label infor-
mation and the classiÔ¨Åcation information are as fully ex-
ploited as possible to ensure the learned representation to
be both discriminative in semantic structure and invariant
across modalities.

The main contributions of this work can be summarised

as follows:

‚Ä¢ A deep supervised cross-modal learning architecture is
proposed to bridge the heterogeneity gap between dif-
ferent modalities. It can effectively learn the common
representations for the heterogeneous data by preserv-
ing the semantic discrimination and modality invari-
ance simultaneously in an end-to-end manner.

‚Ä¢ Two sub-networks with weight sharing constraint at
the last layers are developed to learn the cross-modal
correlation between image and text modalities. Fur-
thermore, the modality-invariance loss is directly for-
mulated into the objective function to eliminate the
cross-modal discrepancy.

‚Ä¢ A linear classiÔ¨Åer is applied to classify the samples in
the common representation space. In this way, DSCM-
R minimises the discrimination loss in both the label
space and the common representation space, which

makes the learned common representations be signiÔ¨Å-
cantly discriminative.

‚Ä¢ Extensive experiments on widely-used benchmark
datasets have been conducted. The results demonstrate
that our method outperforms current state-of-the-art
methods for cross-modal retrieval, which indicates the
effectiveness of the proposed method.

The remainder of this paper is organised as follows. Sec-
tion 2 reviews the related work in cross-modal learning.
Section 3 presents the proposed method, includes the prob-
lem formulation, the DSCMR model, the objective function
and the implementation details. Section 4 provides the ex-
perimental results and analysis. Section 5 concludes this
paper.

2. Related Work

The cross-modal learning methods aim to learn a com-
mon representation space, where the similarity between the
samples from different modalities can be measured direct-
ly. A variety of approaches have been proposed to learn
such a common representation space, which can be roughly
divided into two categories: 1) binary-valued representa-
tion learning [9, 3, 41], also called as cross-modal hashing,
and 2) real-valued representation leaning [30, 19, 21]. The
binary-valued approaches are more geared towards com-
putational efÔ¨Åciency and map the heterogeneous data into
a common Hamming space, in which the cross-modal re-
trieval would be fast. Since the representations are encoded
to binary codes, the retrieval accuracy generally decreases
slightly due to the loss of information [20].

The proposed method in this paper is the one in the
category of real-valued representation learning approaches.
This category includes unsupervised approaches [2, 5, 33],
pairwise approaches [38, 39, 31] and supervised approach-
es [32, 28].
The unsupervised methods only use co-
occurrence information (co-exist in a multimedia documen-
t) to learn common representations for different types of da-
ta. The methods of CCA, Deep CCA (DCCA) [2], Corre-
spondence Auto-encoder (Corr-AE) [5] and Deep Canon-
ically Correlated Auto-encoder (DCCAE) [33] are repre-
sentative ones of this subclass. The pairwise-based meth-
ods utilise more similar pairs to learn a meaning met-
ric for comparing samples from different modalities. The
representative methods of this subclass include the Multi-
view Metric Learning with Global consistency and Local
smoothness (MVML-GL) method [38], the Joint Graph
Regularised Heterogeneous Metric Learning (JGRHML)
method [39] and the Modality-SpeciÔ¨Åc Deep Structure
(MSDS) method[31].

To learn more discriminative common representation-
s, supervised methods exploit label information to distin-
guish the samples from different semantic categories. The

10395

Figure 1. The general framework of the proposed DSCMR method. The images and the text are inputed into an image CNN [13] and a text
CNN [37], respectively, to obtain original high-level semantic representations. Then, a number of fully-connected layers are separately
added on the top of them to map the samples from different modalities into a common representation space. Finally, a linear classiÔ¨Åer (with
parameters in P) is used to predict the category of each sample to supervise the network to learn cross-modal transformation functions f (¬∑)
and g(¬∑).

supervised methods enforce different-category samples to
be transformed far apart while the same-category samples
lie as close as possible. To obtain such a common space,
Sharama et al. [28] proposed a supervised extension of C-
CA, named as Generalised Multi-view Analysis (GMA), by
using the semantic category labels to guide the learning of
common representations. The recently proposed methods
in [9], [22] and [30] also exploited semantic category label-
s to learn discriminative features for cross-modal retrieval.
In [22] and [30], the adversarial learning [6] has been em-
ployed to improve the performance of cross-modal learning
as well. They both have achieved promising performance
on cross-modal retrieval tasks.

This paper is dedicated to fully exploit the classiÔ¨Åcation
information to guide the model learning more discrimina-
tive and modal-invariant representations for the data of d-
ifferent types and bridge the heterogeneity gap, and thus
improving the cross-modal retrieval accuracy.

3. The Proposed Method

In this section, we Ô¨Årst introduce the formulation of the
cross-modal retrieval problem. Then, we present the pro-
posed method to learn the common presentations of data
from different modalities. At last, we provide more imple-
mentation details of the proposed method.

3.1. Problem Formulation

Without losing generality, we focus on cross-modal re-
trieval for bimodal data, i.e., for images and text. We as-
sume that there is a collection of n instances of image-text

i , xŒ≤

i )}n

i=1, where xŒ±
i

pairs, denoted as Œ® = {(xŒ±
is the in-
put image sample and xŒ≤
i is the input text sample of the ith
instance. Each pair of instances (xŒ±
i ) has been assigned
a semantic label vector yi = [y1i, y2i, . . . , yci] ‚àà Rc, where
c is the number of the categories. If the ith instance belongs
to the jth category, yji = 1, otherwise yji = 0.

i , xŒ≤

Since the image feature vectors and text feature vec-
tors typically have different statistical properties and lie
in different representation spaces, they cannot be directly
compared against each other for cross-modal retrieval [30].
Cross-modal learning is to learn two functions for two
modalities: ui = f (xŒ±
i ; Œ•Œ±) ‚àà Rd for the image modal-
ity and vj = g(xŒ≤
j ; Œ•Œ≤) ‚àà Rd for the text modality, where
d is the dimensionality of the representation in the common
representation space, and Œ•Œ± and Œ•Œ≤ are the trainable pa-
rameters of the two functions.
It makes the samples can
be compared directly even though they come from different
modalities, and in the common space, the similarity of the
samples from the same category is larger than the similarity
of the samples from the different categories. Therefore, the
relevant samples of different data types in the data set can
be returned for one query of any data type. In the follow-
ing, the image representation matrix, the text representation
matrix and the label matrix for all instances in Œ® are de-
noted as U = [u1, u2, . . . , un], V = [v1, v2, . . . , vn] and
Y = [y1, y2, . . . , yn] with ui be the learned image rep-
resentation for the ith instance and vj be the learned text
representation for the jth instance in the common represen-
tation space.

10396

Image modalityText modalityA blue-green hummingbird sits upon a twig.A multicolored bird sits on a branch. Blue and green bird perched on a twig.Blue and Green Hummingbird sitting on a branch.Small bird with colorful feathers perched on a branch.Common spaceLabel spaceLabel: ùêòùí•3: Inter-modal invariance lossùí•2: Discrimination loss in common spaceùí•1: Discrimination loss in label space‚Ä¶Image CNNText CNN‚Ä¶ùêèùêèOriginal high-level representations3.2. Framework of DSCMR

The general framework of the proposed method is shown
in Figure 1, from which we can see that it includes t-
wo sub-networks, one for image modality and another for
text modality, and they are trained in an end-to-end man-
ner. The convolutional layers of the deep neural network
for image modality are the same as those in 19-layer VG-
GNet [29], which is pre-trained on the ImageNet. We gener-
ate 4, 096-dimensional feature vector from fc7 layer as the
original high-level semantic representation for image, de-
noted as hŒ±
i . Then, several fully-connected layers conduct
the common representation learning to obtain the common
representation for each image, denoted as ui. To perfor-
m common representation learning for text, we employ the
Word2Vec model [16], which is pre-trained on billions of
words in Google News, to represent each network as a k-
dimensional feature vector Ô¨Årst. Thus, each text can be rep-
resented as a matrix with each column as a k-dimensional
feature vector. Then, the text matrix is feed to the convo-
lutional layers as same the conÔ¨Åguration as sentence CN-
N [37] to generate the original high-level semantic repre-
sentation for text, denoted as hŒ≤
i . In a similar way, a num-
ber of fully-connected layers are followed to learn the com-
mon representation for text, denoted as vi. To ensure the
two sub-networks to learn a common representation space
for image and text modalities, we enforce these two sub-
networks to share the weights of their last layers. This is
intuitively to generate as similar as possible representations
for the image and text samples from the same category.

Finally, based on the assumption that the common repre-
sentations in the common space are ideal for classiÔ¨Åcation,
a linear classiÔ¨Åer with the parameter matrix P is connected
to these two sub-networks to learn discriminative features
by exploiting the label information. Therefore, the cross-
modal correlation could be well learned and the discrimina-
tive features can be simultaneously exacted.

3.3. Objective Function

The goal of DSCMR is to learn the semantic structure of
the data, i.e., to learn a common space where the samples
from the same semantic category should be similar, even
though these data may come from different modalities, and
the samples from different semantic categories should be
dissimilar. To learn discriminative features of the multime-
dia data, we propose to minimise the discrimination loss in
both the label space and the common representation space.
Simultaneously, we minimise the distance between the rep-
resentations of each image-text pair to reduce the cross-
modal discrepancy as well.
In the following, we present
more details about the objective function of our DSCMR.

To preserve the discrimination of samples from different
categories after the feature projection, we assume that the
common representations are ideal for classiÔ¨Åcation and use

a linear classiÔ¨Åer to predict the semantic labels of the sam-
ples projected in the common representation space. Specif-
ically, a linear layer is connected on the top of the image
modal network and the text modal network. This classiÔ¨Åer
takes the representations of the training data in the com-
mon space and generates a predicted label of c-dimensional
vector for each sample. We propose the following objec-
tive function to measure the discrimination loss in the label
space:

J1 =

1
n

kPT U ‚àí YkF +

1
n

kPT V ‚àí YkF ,

(1)

where k¬∑kF denotes the Frobenius norm, P is the projection
matrix of the linear classiÔ¨Åer.

Furthermore, we also measure the discrimination loss of
all samples from both modalities in the common represen-
tation space directly:

J2 =

1
n2

n

Xi,j=1

(log(1 + eŒìij ) ‚àí SŒ±Œ≤

ij Œìij)

|

+

+

1
n2

|

1
n2

n

Xi,j=1

n

Xi,j=1

inter-modalities

{z

}

}

(log(1 + eŒ¶ij ) ‚àí SŒ±Œ±

ij Œ¶ij)

(2)

image modality

{z

log(1 + eŒòij ) ‚àí SŒ≤Œ≤

ij Œòij)

,

1

}

text modality

{z

2 cos(ui, vj), Œ¶ij = 1
ij = 1{ui, vj}, SŒ±Œ±

|
where Œìij = 1
2 cos(ui, uj), Œòij =
2 cos(vi, vj), SŒ±Œ≤
ij =
1{vi, vj}, cos(¬∑) is the cosine function used to compute the
similarity between two input vectors, and 1{¬∑} is an indi-
cator function, whose value is 1 if the two elements are the
representations of intra-class samples, otherwise 0. The Ô¨Årst
term of Equation (2) is the negative log likelihood of the
inter-modal sample similarities with the likelihood function
deÔ¨Åned as follows:

ij = 1{ui, uj}, SŒ≤Œ≤

p(SŒ±Œ≤

ij |ui, vj) = (cid:26) Œ¥(Œìij),

1 ‚àí Œ¥(Œìij),

if SŒ±Œ≤

ij = 1;
otherwise,

(3)

1

where Œ¥(Œìij) =
1+e‚àíŒìij is the sigmoid function. It is easy
to Ô¨Ånd that minimising this negative log likelihood function
is equivalent to maximising the likelihood. We can also see
that, the larger the similarity (cosine similarity cos(ui, vj))
is, the larger p(1|ui, vj) will be, which implies that should
be classiÔ¨Åed as similar, and vice versa. Likely, the second
and the third terms measure the similarities of the image
samples and the text samples, respectively. Therefore, E-
quation (2) is a reasonable similarity measure for common

10397

representations and is a well criterion for learning discrimi-
native features.

To eliminate the cross-modal discrepancy, we propose
to minimise the distance between the representations of all
image-text pairs. Technically, we formulate the modality
invariance loss as follows:

J3 =

1
n

kU ‚àí VkF .

(4)

Combining Equations (1), (2) and (4), we obtain the ob-

jective function of the proposed method DSCMR as:

J = J1 + ŒªJ2 + Œ∑J3,

(5)

where the hyper-parameters Œª and Œ∑ control the contribu-
tions of the last two components, and n is the number of the
input instances. The objective function of DSCMR in Equa-
tion (5) can be optimised using a stochastic gradient descent
optimisation algorithm [12]. The details of the optimisation
procedure are summarised in Algorithm 1.

Algorithm 1 Optimisation procedure of the proposed D-
SCMR
Input: The training data set Œ® = {(xŒ±

i=1, the label
matrix Y, the dimensionality of the common represen-
tation space d, the batch size nb, the learning rate œÑ , the
maximal number of epochs ‚Ñµ, and the hyper parameters
Œª and Œ∑.

i , xŒ≤

i )}n

Output: The optimised parameters in the two sub-

networks Œ•Œ±, Œ•Œ≤.

1: Randomly initialise the parameters of the two sub-
networks Œ•Œ±, Œ•Œ≤ and the parameters of the linear clas-
siÔ¨Åer P.

2: for t = 1, 2, . . . , ‚Ñµ do
for ‚Ñì = 1, 2, . . . , ‚åä n
3:
nb

‚åã do

4:

5:

6:

7:

8:

for
in the mini-batch by forward-

Randomly sample nb image-text pair samples
from Œ® to construct a mini-batch.
Compute the representations ui and vj
the samples
propagation.
Calculate the result of the objective function in E-
quation (5).
Update the parameters of the linear classiÔ¨Åer P by
minimising J in Equation (5) with:
P = (UUT )‚àí1UT Y + (VVT )‚àí1VT Y.
Update the parameters of the sub-networks, Œ•Œ±
and Œ•Œ≤, by minimising J in Equation (5) with de-
scending their stochastic gradient:
Œ•Œ± = Œ•Œ± ‚àí œÑ ‚àÇJ
‚àÇŒ•Œ±

; Œ•Œ≤ = Œ•Œ≤ ‚àí œÑ ‚àÇJ
‚àÇŒ•Œ≤

.

end for

9:
10: end for

3.4. Implementation Details

In this work, there are two sub-networks, one for im-
age modality and the other for text modality. The convo-
lutional layers have the same conÔ¨Åguration with 19-layer
VGGNet [29] for image sub-network and the sentence C-
NN [37] for text sub-network as mentioned in Section 3.2.
Then two fully-connected layers with RectiÔ¨Åed Linear U-
nit (ReLU) [17] active function are followed in each sub-
network. The numbers of the hidden units for the two layers
are 2, 048 and 1, 024, respectively. The weights of the sec-
ond fully-layers of the two sub-networks are shared to learn
the correlation of two different modalities.

The entire network is trained on a Nvidia GTX 1080 Ti
GPU in PyTorch. For training, we employ the ADAM [12]
optimiser with a learning rate of 10‚àí4 and set the maximal
number of epochs as 500.

4. Experiments

To verify the effectiveness of the proposed method,
we conduct experiments on four widely-used benchmark
datasets:
the Wikipedia dataset [24], the Pascal Sentence
dataset [26], the NUS-WIDE-10k dataset [4] and the X-
MediaNet dataset [20, 23]. In the experiments, we Ô¨Årstly
compare the proposed DSCMR method with the state-of-
the-art methods to evaluate its performance. Then, we pro-
vide further analysis of the DSCMR method. It includes the
convergency investigation, the visualisation of the learned
representation in the common representation space and the
impact of different components in Equation (5).

4.1. Datasets and Features

In our experiments, we follow the dataset partition and
feature exaction strategies from [22, 25]. We adopt a 19-
layer VGGNet [29] to learn the representations of the sam-
ples and obtain a 4, 096-dimensional representation vector
outputted by the fc7 layer of the VGGNet for each im-
age. For representing text samples, we use the sentence
CNN [37] to learn a 300-dimensional representation vec-
tor for each text. The statistical results of the three datasets
are summarised in Table 1. It is notable that all the com-
pared methods adopt the same CNN features as for both
image and text obtained by the CNN architectures used in
our method.

4.2. Evaluation Metric

We evaluate the compared methods by using the mean
Average Precision (mAP) score for all returned results with
cosine similarity on all the four datasets. The mAP met-
ric jointly considers the ranking information and precision,
which is a widely-used performance evaluation criterion in
the research on cross-modal retrieval [32, 19, 30]. In our
experiments, we report the mAP scores of the compared

10398

Table 1. Statistical results of the four benchmark datasets used in
our experiments, where ntrain and ntest stand for the numbers of
training and test image-text pairs, respectively. The symbol c is
the number of categories, di and dt are the dimensionalities of the
image and text features obtained by VGGNet [29] and sentence
CNN [37], respectively.

Dataset
Wikipedia
Pascal Sentence
NUS-WIDE-10k
XMediaNet

ntrain
2,173
800
8,000
32,000

ntest
462
100
1,000
4,000

c
10
20
10
200

di
4,096
4,096
4,096
4,096

dt
300
300
300
300

methods for two different cross-modal retrieval tasks: 1) re-
trieving text samples using image queries (Image2Text) and
2) retrieving images using text queries (Text2Image).

4.3. Comparison with State of the art Methods

To verify the effectiveness of our proposed methods,
we compare the proposed method with ten state-of-the-art
methods in the experiments, including Ô¨Åve traditional meth-
ods, namely CCA [8], MCCA [27], MvDA [10], MvDA-
VC [11] and JRL [40], as well as Ô¨Åve deep learning-based
methods, namely CMDN [19], CCL [21], DCCA [2], DC-
CAE [33] and ACMR [30].

Table 2. Performance comparison in terms of mAP scores on the
Wikipedia dataset. The highest score is shown in boldface.

Method
CCA [8]
MCCA [27]
MvDA [10]
MvDA-VC [11]
JRL [40]
CMDN [19]
CCL [21]
DCCA [2]
DCCAE [33]
ACMR [30]
Ours

Image2Text Text2Image Average
0.134
0.341
0.337
0.388
0.449
0.487
0.504
0.444
0.435
0.477
0.521

0.133
0.307
0.308
0.358
0.418
0.427
0.457
0.396
0.385
0.434
0.478

0.134
0.324
0.323
0.373
0.434
0.457
0.481
0.420
0.410
0.456
0.499

Tables 2-5 report the mAP scores of the proposed D-
SCMR and the compared methods on the four benchmark
datasets (the mAP score results of CCL [21] and CMD-
N [19] are provided by their authors), from which we have
the following observations:

‚Ä¢ DSCMR signiÔ¨Åcantly outperforms both the traditional
peer methods and the deep learning-based methods on
all of the four datasets. SpeciÔ¨Åcally, DSCMR outper-
forms the second-best methods with an improvement
of 0.018, 0.038, 0.020 and 0.050 in terms of average

Table 3. Performance comparison in terms of mAP scores on the
Pascal Sentence dataset. The highest score is shown in boldface.

Method
CCA [8]
MCCA [27]
MvDA [10]
MvDA-VC [11]
JRL [40]
CMDN [19]
CCL [21]
DCCA [2]
DCCAE [33]
ACMR [30]
Ours

Image2Text Text2Image Average
0.225
0.664
0.594
0.648
0.527
0.544
0.576
0.678
0.680
0.671
0.710

0.227
0.689
0.626
0.673
0.534
0.526
0.561
0.677
0.671
0.676
0.722

0.226
0.677
0.610
0.661
0.531
0.535
0.569
0.678
0.675
0.673
0.716

Table 4. Performance comparison in terms of mAP scores on the
NUS-WIDE-10K dataset. The highest score is shown in boldface.

Method
CCA [8]
MCCA [27]
MvDA [10]
MvDA-VC [11]
JRL [40]
CMDN [19]
CCL [21]
DCCA [2]
DCCAE [33]
ACMR [30]
Ours

Image2Text Text2Image Average
0.378
0.448
0.501
0.526
0.586
0.492
0.506
0.532
0.511
0.588
0.611

0.394
0.462
0.526
0.557
0.598
0.515
0.535
0.549
0.540
0.599
0.615

0.386
0.455
0.513
0.542
0.592
0.504
0.521
0.540
0.525
0.593
0.613

Table 5. Performance comparison in terms of mAP scores on the
XMEDIANET dataset. The highest score is shown in boldface.

Method
CCA [8]
MCCA [27]
MvDA [10]
MvDA-VC [11]
JRL [40]
CMDN [19]
CCL [21]
DCCA [2]
DCCAE [33]
ACMR [30]
Ours

Image2Text Text2Image Average
0.598
0.620
0.651
0.650
0.586
0.485
0.537
0.583
0.594
0.639
0.697

0.595
0.616
0.639
0.627
0.578
0.516
0.528
0.596
0.606
0.639
0.693

0.597
0.618
0.645
0.638
0.582
0.501
0.533
0.590
0.600
0.639
0.695

mAP scores on the Wikipedia, Pascal Sentence, NUS-
WIDE-10k and XMediaNet datasets, respectively.

‚Ä¢ The nonlinear transformations in the deep learning-

10399

based methods can be helpful to improve the perfor-
mance of the traditional methods, e.g., DCCA outper-
forms CCA with a signiÔ¨Åcant margin on the Ô¨Årst three
datasets.

‚Ä¢ The traditional methods with the deep features could
also potentially be able to achieve a high mAP s-
core on cross-modal retrieval. For example, the linear
methods CCA, MCCA, MvDA, MvDA-VC and JR-
L obtained promising results (average mAP of 0.597,
0.618, 0.645, 0.638 and 0.582) on the XMediaNet
dataset. This may be contributed to that the image CN-
N and the text CNN have transformed the input image
and text samples into approximately linear subspaces,
which signiÔ¨Åcantly reduced the difÔ¨Åculty of the origi-
nal cross-modal learning task.

4.4. Further Analysis on DSCMR

4.4.1 Convergency

Figure 2 shows the value of the objective function of our
method versus the different number of training epochs on
the Pascal Sentence dataset. From the result, we can see
that during the entire training procedure, the value of the
objective function decreases almost monotonously and con-
verges smoothly. The value of the objective function of D-
SCMR becomes stable after 500 epochs, which illustrates
that the proposed method can be efÔ¨Åciently trained by us-
ing the stochastic gradient descent optimisation algorithm
Adam [12].

e
u
l
a
v

 
e
v
i
t
c
e
j
b
O

1.2

1

0.8

0.6

0.4

0.2

0

0

200

400

600
Learning epoch

800

1000

Figure 2. The value of the objective function of DSCMR versus
the different number of training epochs on the Pascal Sentence
dataset.

4.4.2 Visualisation of the Learned Representation

To visually investigate the effectiveness of the proposed D-
SCMR, we adopt the t-SNE approach to embed the repre-
sentations of the image and text samples (in the common
representation space) into a two-dimensional visualisation
plane. The results of the original images represented by
the 4, 096-dimensional (VGGNet [29]) features and the text
samples represented by the 300-dimensional (sentence CN-
N [37]) features (after the embedding process) are displayed

in Figure 3(d) and Figure 3(e), respectively. We can see that
the distributions of the image modality and the text modality
in the Wikipedia dataset are largely different and the sam-
ples are hard to be classiÔ¨Åed in the original input space.

Figure 3(a) and Figure 3(b) show the two-dimensional
distributions of the image and text representations in the
common space. From the results, we can see that the formu-
lation of the discrimination loss in both the common space
and the label space is able to model the discrimination be-
tween the samples from different semantic categories, and
effectively separates the representations into several seman-
tically discriminative clusters. We can also Ô¨Ånd that a s-
mall number of the representations from different seman-
tic categories are mixed together, which makes DSCMR
returns some irrelevant results for a query. These result-
s are in accordance with the retrieval results shown in Ta-
ble 2. Furthermore, the distributions of image modality and
text modality in Figure 3(c) are well mixed together and
are difÔ¨Åcult to be separated from each other. It means that
the cross-modal discrepancy is largely reduced by using the
proposed method.

4.4.3

Impact of Different Components

The objective function of the proposed DSCMR combines
three terms, which aim to minimise the discrimination loss
in the label space, the discrimination loss in the common
representation space, and the modality invariance loss in the
common representation space, respectively. To investigate
the impact of these terms on the performance of the pro-
posed method, we developed and evaluated four variation-
s of DSCMR: DSCMR without J1 (DSCMR1), DSCMR
without J2 (DSCMR2), DSCMR without J3 (DSCMR3)
and DSCMR only with J1 (DSCMR4). The optimisation
procedure of these four cases is similar to the proposed D-
SCMR.

Table 6. Performance comparison of the proposed DSCMR and
its four variations in terms of mAP scores on the Pascal Sentence
dataset. The highest score is shown in boldface.

Image2Text Text2Image Average
Method
0.583
DSCMR1
0.708
DSCMR2
DSCMR3
0.691
0.690
DSCMR4
Full DSCMR 0.710

0.631
0.722
0.683
0.680
0.722

0.607
0.715
0.694
0.685
0.716

Table 6 and Table 7 show the performance comparisons
of DSCMR and its four variations on the Pascal Sentence
dataset and the NUS-WIDE-10K dataset. From the result-
s, we can see that the full DSCMR performs best on both
datasets, which indicates that all of the three terms in the

10400

80

60

40

20

0

-20

-40

-60

-40

-20

0

20

40

80

60

40

20

0

-20

-40

-60

-40

-20

0

20

40

80

60

40

20

0

-20

-40

-60

-40

-20

0

20

40

(a) Image representations

(b) Text representations

(c) Image and text representations

30

20

10

0

-10

-20

-30

-40

-20

0

20

40

40
30

20

10

0

-10

-20

-30

-40

-40

-20

0

20

40

(d) Original image samples

(e) Original text samples

Figure 3. The visualisation for the test data in the Wikipedia dataset by using the t-SNE method [15]. The triangles denote the samples from
image modality and the circles denote the samples from text modality. The samples come the same semantic category are marked with the
same colour. (a) the image representations in the common representation space. (b) the text representations in the common representation
space. (c) the image and text representations in the common representation space. (d) the original image samples represented by the 4, 096-
dimensional (VGGNet [29]) features. (e) the original text samples represented by the 300-dimensional (sentence CNN [37]) features.

Table 7. Performance comparison of the proposed DSCMR and its
four variations in terms of mAP scores on the NUS-WIDE-10K
dataset. The highest score is shown in boldface.

Image2Text Text2Image Average
Method
0.267
DSCMR1
0.610
DSCMR2
0.534
DSCMR3
0.527
DSCMR4
Full DSCMR 0.611

0.265
0.611
0.538
0.524
0.613

0.262
0.612
0.541
0.520
0.615

objective function contribute to the Ô¨Ånal retrieval accuracy.
We can also see that DSCMR outperforms DSCMR1 with
a large margin, which demonstrates the importance of the
Ô¨Årst term (the discrimination loss in the label space). Fur-
thermore, DSCMR4 (the variation only with the Ô¨Årst term)
obtained competitive results on both datasets. This also in-
dicates that the importance of the Ô¨Årst term for the model
to learn modal-invariant discriminative features. Howev-
er, DSCMR4 is still inferior to the DSCMR2 and DSCM-
R3, which demonstrates the signiÔ¨Åcance of the second term
and the third term of the proposed method. Based on the
above analysis, we Ô¨Ånd that formulating both the discrimi-
nation loss and the inter-modal invariance loss in the objec-
tive function is a valuable strategy for multimodal learning.

5. Conclusion

In this paper, we proposed a new approach (DSCMR) to
learn common representations for heterogeneous data. The
learned common representations can be both discriminative
and modality-invariant for cross-modal retrieval. DSCM-
R achieved this goal by minimising the discrimination loss
(in the common representation space and the label space)
and modality invariance loss simultaneously. Extensive ex-
perimental results on four widely-used benchmark datasets
and the comprehensive analysis have demonstrated the ef-
fectiveness of the proposed cross-modal learning strategy,
leading to superior cross-modal retrieval performance com-
pared to state-of-the-art methods.

Acknowledgement

This work is supported by National Key R&D Program
of China under contract No. 2017YFB1002201 and par-
tially supported by the National Natural Science Foun-
dation of China under Grants No. 61625204, 61836006
and U1831121,
the SCU-LuZhou Sciences and Tech-
nology Coorperation Program (Grant No. 2017CDLZ-
G25), and the Sichuan Science and Technology Plan-
ning Projects (Grants No. 18PTDJ0085, 2019YFH0075,
2018GZDZX0030).

10401

References

[1] S. Akaho. A kernel method for canonical correlation analy-
sis. In Proceedings of the International Meeting of Psycho-
metric Society, pages 263‚Äì269, 2001. 1

[2] G. Andrew, R. Arora, J. Bilmes, and K. Livescu. Deep
canonical correlation analysis. In Proceedings of the Interna-
tional Conference on Machine Learning, pages 1247‚Äì1255,
2013. 1, 2, 6

[3] Y. Cao, M. Long, J. Wang, Q. Yang, and P. S. Yu. Deep
visual-semantic hashing for cross-modal retrieval.
In Pro-
ceedings of the 22nd ACM SIGKDD International Con-
ference on Knowledge Discovery and Data Mining, pages
1445‚Äì1454, New York, NY, USA, 2016. ACM. 2

[4] T.-S. Chua, J. Tang, R. Hong, H. Li, Z. Luo, and Y. Zheng.
Nus-wide: A real-world web image database from national
university of singapore. In Proceedings of the ACM Inter-
national Conference on Image and Video Retrieval, pages
48:1‚Äì48:9, New York, NY, USA, 2009. ACM. 5

[5] F. Feng, X. Wang, and R. Li. Cross-modal retrieval with cor-
respondence autoencoder. In Proceedings of the 22nd ACM
International Conference on Multimedia, pages 7‚Äì16, New
York, NY, USA, 2014. ACM. 2

[6] I. J. Goodfellow, J. Pouget-Abadie, M. Mirza, B. Xu,
D. Warde-Farley, S. Ozair, A. Courville, and Y. Bengio. Gen-
erative adversarial nets.
In Proceedings of the 27th Inter-
national Conference on Neural Information Processing Sys-
tems, pages 2672‚Äì2680, Cambridge, MA, USA, 2014. MIT
Press. 3

[7] J. Gu, J. Cai, S. Joty, L. Niu, and G. Wang. Look, imagine
and match: Improving textual-visual cross-modal retrieval
with generative models.
In Proceedings of the IEEE Con-
ference on Computer Vision and Pattern Recognition, pages
7181‚Äì7189, 2018. 1

[8] H. Hotelling.

Relations between two sets of variates.

Biometrika, 28(3/4):321‚Äì377, 1936. 1, 6

[9] Q. Jiang and W. Li. Deep cross-modal hashing. In Proceed-
ings of the 2017 IEEE Conference on Computer Vision and
Pattern Recognition, pages 3270‚Äì3278. IEEE, 2017. 1, 2, 3
[10] M. Kan, S. Shan, H. Zhang, S. Lao, and X. Chen. Multi-
view discriminant analysis. In Proceedings of the European
Conference on Computer Vision, pages 808‚Äì821, 2012. 6

[11] M. Kan, S. Shan, H. Zhang, S. Lao, and X. Chen. Multi-view
discriminant analysis. IEEE transactions on pattern analysis
and machine intelligence, 38(1):188‚Äì194, 2016. 6

[12] D. P. Kingma and J. Ba. Adam: A method for stochastic

optimization, 2014. 5, 7

[13] A. Krizhevsky, I. Sutskever, and G. E. Hinton.

Imagenet
classiÔ¨Åcation with deep convolutional neural networks.
In
Proceedings of the Advances in neural information process-
ing systems, pages 1097‚Äì1105, 2012. 3

[14] Y. LeCun, Y. Bengio, and G. Hinton. Deep learning. Nature,

521(7553):436, 2015. 1

[15] L. v. d. Maaten and G. Hinton. Visualizing data using t-sne.
Journal of machine learning research, 9(Nov):2579‚Äì2605,
2008. 8

In Proceedings of the 26th Internation-
compositionality.
al Conference on Neural Information Processing Systems,
pages 3111‚Äì3119, USA, 2013. Curran Associates Inc. 4

[17] V. Nair and G. E. Hinton. RectiÔ¨Åed linear units improve
restricted boltzmann machines. In Proceedings of the 27th
International Conference on Machine Learning, ICML‚Äô10,
pages 807‚Äì814, USA, 2010. Omnipress. 5

[18] J. Ngiam, A. Khosla, M. Kim, J. Nam, H. Lee, and A. Y.
Ng. Multimodal deep learning. In Proceedings of the 28th
international conference on machine learning, pages 689‚Äì
696, 2011. 1

[19] Y. Peng, X. Huang, and J. Qi. Cross-media shared represen-
tation by hierarchical learning with multiple deep networks.
In Proceedings of the International Joint Conference on Ar-
tiÔ¨Åcial Intelligence, pages 3846‚Äì3853, 2016. 1, 2, 5, 6

[20] Y. Peng, X. Huang, and Y. Zhao. An overview of cross-
media retrieval: Concepts, methodologies, benchmarks and
challenges. IEEE Transactions on Circuits and Systems for
Video Technology, 2017. 1, 2, 5

[21] Y. Peng, J. Qi, X. Huang, and Y. Yuan. CCL: Cross-modal
correlation learning with multigrained fusion by hierarchical
network. IEEE Transactions on Multimedia, 20(2):405‚Äì420,
Feb 2018. 1, 2, 6

[22] Y. Peng, J. Qi, and Y. Yuan. CM-GANs: Cross-modal gener-
ative adversarial networks for common representation learn-
ing. ACM Transactions on Multimedia Computing, Commu-
nications, and Applications, 2018. 3, 5

[23] Y. Peng, J. Qi, and Y. Yuan. Modality-speciÔ¨Åc cross-modal
similarity measurement with recurrent attention network.
IEEE Transactions on Image Processing, 27(11):1‚Äì1, Nov.
2018. 5

[24] J. C. Pereira, E. Coviello, G. Doyle, N. Rasiwasia, G. R. G.
Lanckriet, R. Levy, and N. Vasconcelos. On the role of cor-
relation and abstraction in cross-modal multimedia retrieval.
IEEE Transactions on Pattern Analysis and Machine Intelli-
gence, 36(3):521‚Äì535, March 2014. 5

[25] J. Qi and Y. Peng. Cross-modal bidirectional translation
via reinforcement learning.
In Proceedings of the Twenty-
Seventh International Joint Conference on ArtiÔ¨Åcial Intelli-
gence, pages 2630‚Äì2636, July 2018. 1, 5

[26] C. Rashtchian, P. Young, M. Hodosh, and J. Hockenmaier.
Collecting image annotations using amazon‚Äôs mechanical
turk.
In Proceedings of the NAACL HLT 2010 Workshop
on Creating Speech and Language Data with Amazon‚Äôs Me-
chanical Turk, pages 139‚Äì147, Stroudsburg, PA, USA, 2010.
Association for Computational Linguistics. 5

[27] J. Rupnik and J. Shawe-Taylor. Multi-view canonical corre-
lation analysis. In Proceedings of the Conference on Data
Mining and Data Warehouses, pages 1‚Äì4, 2010. 6

[28] A. Sharma, A. Kumar, H. Daume, and D. W. Jacobs. Gen-
eralized multiview analysis: A discriminative latent space.
In Proceedings of the IEEE Conference on Computer Vision
and Pattern Recognition, pages 2160‚Äì2167, June 2012. 2, 3
[29] K. Simonyan and A. Zisserman. Very deep convolutional
networks for large-scale image recognition. arXiv preprint
arXiv:1409.1556, 2014. 4, 5, 6, 7, 8

[16] T. Mikolov, I. Sutskever, K. Chen, G. Corrado, and J. Dean.
Distributed representations of words and phrases and their

[30] B. Wang, Y. Yang, X. Xu, A. Hanjalic, and H. T. Shen. Ad-
versarial cross-modal retrieval. In Proceedings of the 2017

10402

ACM on Multimedia Conference, pages 154‚Äì162. ACM,
2017. 1, 2, 3, 5, 6

[31] J. Wang, Y. He, C. Kang, S. Xiang, and C. Pan. Image-text
cross-modal retrieval via modality-speciÔ¨Åc feature learning.
In Proceedings of the 5th ACM on International Conference
on Multimedia Retrieval, pages 347‚Äì354, New York, NY,
USA, 2015. ACM. 2

[32] K. Wang, Q. Yin, W. Wang, S. Wu, and L. Wang. A compre-

hensive survey on cross-modal retrieval, 2016. 1, 2, 5

[33] W. Wang, R. Arora, K. Livescu, and J. Bilmes. On deep
multi-view representation learning. In Proceedings of the In-
ternational Conference on Machine Learning, pages 1083‚Äì
1092, 2015. 1, 2, 6

[34] W. Wang and K. Livescu. Large-scale approximate kernel
canonical correlation analysis. In Proceedings of the Inter-
national Conference on Learning Representations, 2016. 1

[35] W. Wang, X. Yang, B. C. Ooi, D. Zhang, and Y. Zhuang. Ef-
fective deep learning-based multi-modal retrieval. The VLDB
Journal, 25(1):79‚Äì101, Feb. 2016. 2

[36] Y. Wei, Y. Zhao, C. Lu, S. Wei, L. Liu, Z. Zhu, and S. Yan.
Cross-modal retrieval with cnn visual features: A new base-
line. IEEE Transactions on Cybernetics, 47(2):449‚Äì460, Feb
2017. 1

[37] K. Y. Convolutional neural networks for sentence classiÔ¨Å-
cation. In Proceedings of the 2014 Conference on Empirical
Methods in Natural Language Processing, pages 1746‚Äì1751,
2014. 3, 4, 5, 6, 7, 8

[38] D. Zhai, H. Chang, S. Shan, X. Chen, and W. Gao. Mul-
tiview metric learning with global consistency and local s-
moothness. ACM Transactions on Intelligent Systems and
Technology, 3(3):53:1‚Äì53:22, May 2012. 2

[39] X. Zhai, Y. Peng, and J. Xiao. Heterogeneous metric learn-
ing with joint graph regularization for cross-media retrieval.
In Proceedings of the Twenty-Seventh AAAI Conference on
ArtiÔ¨Åcial Intelligence, pages 1198‚Äì1204. AAAI Press, 2013.
2

[40] X. Zhai, Y. Peng, and J. Xiao. Learning cross-media join-
t representation with sparse and semisupervised regulariza-
tion. IEEE Transactions on Circuits and Systems for Video
Technology, 24(6):965‚Äì978, 2014. 6

[41] F. Zheng, Y. Tang, and L. Shao. Hetero-manifold regularisa-
tion for cross-modal hashing. IEEE transactions on pattern
analysis and machine intelligence, 40(5):1059‚Äì1071, 2018.
2

10403

