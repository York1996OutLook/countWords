Re-IdentiÔ¨Åcation with Consistent Attentive Siamese Networks

1Department of Electrical, Computer, and Systems Engineering, Rensselaer Polytechnic Institute, Troy NY

Meng Zheng1, Srikrishna Karanam2, Ziyan Wu2, and Richard J. Radke1

2Siemens Corporate Technology, Princeton NJ

zhengm3@rpi.edu,{first.last}@siemens.com,rjradke@ecse.rpi.edu

Abstract

We propose a new deep architecture for person re-
identiÔ¨Åcation (re-id). While re-id has seen much recent
progress, spatial localization and view-invariant represen-
tation learning for robust cross-view matching remain key,
unsolved problems. We address these questions by means
of a new attention-driven Siamese learning architecture,
called the Consistent Attentive Siamese Network. Our key
innovations compared to existing, competing methods in-
clude (a) a Ô¨Çexible framework design that produces atten-
tion with only identity labels as supervision, (b) explicit
mechanisms to enforce attention consistency among images
of the same person, and (c) a new Siamese framework that
integrates attention and attention consistency, producing
principled supervisory signals as well as the Ô¨Årst mech-
anism that can explain the reasoning behind the Siamese
framework‚Äôs predictions. We conduct extensive evaluations
on the CUHK03-NP, DukeMTMC-ReID, and Market-1501
datasets and report competitive performance.

1. Introduction

Given an image or a set of images of a person of inter-
est in a ‚Äúprobe‚Äù camera view, person re-identiÔ¨Åcation (re-
id) attempts to retrieve this person of interest among a set
of ‚Äúgallery‚Äù candidates in another camera view. Due to its
broad appeal in several video analytics applications such as
surveillance, re-id has seen explosive growth in the com-
puter vision community [15, 44, 45].

While we have seen tremendous progress in re-id [4, 5,
28, 31, 32, 34, 36, 37], there are several problems that still
hinder the reliable, real-world use of person re-id. Probe
and gallery camera views in real-world applications typi-
cally have large viewpoint variations, causing substantial
view misalignment between probe and gallery images of
the same person. Illumination differences between the lo-
cations where the cameras are installed, as well as occlu-
sions in the captured data, add to re-id‚Äôs challenges. Ideally,
we want a method that can reliably spatially localize the

Figure 1: We present the Ô¨Årst framework for re-id that pro-
vides mechanisms to make attention and attention consis-
tency end-to-end trainable in a Siamese learning architec-
ture, resulting in a technique for robust cross-view match-
ing as well as explaining the reasoning for why the model
predicts that the two images belong to the same person.

person of interest in the image, while also providing a ro-
bust representation of the localized part in order to match
accurately to the gallery of candidates. This suggests we
consider the spatial localization and feature representation
problems jointly and formulate the learning objective in a
way that can facilitate end-to-end learning.

Attention is a powerful concept for understanding and
interpreting neural network decisions [9, 25, 27, 49], pro-
viding ways to generate attentive regions given image-level
labels and trained models, and to perform spatial localiza-
tion. Unlike its use as a weight matrix in some existing work
[2, 3, 35], here we refer to attention computed by means
of class-speciÔ¨Åc gradient backpropagation [27, 49]. Some
recent extensions [18] take this a step forward by training
models with attention providing end-to-end supervision, re-
sulting in improved spatial localization. These methods
were not designed for the re-id problem and consequently
did not have to consider localization and invariant represen-
tation learning jointly. While there have been some attempts
at joint learning with these two objectives [17, 21, 24, 38],
these methods do not explicitly enforce any sort of atten-
tion consistency between images of the same person. In-
tuitively, given same-person images from different views,

5735

Same Person?YesSiamese AttentionAttention ConsistencyRe-IdentificationExplanationConsistencythere typically exist some common regions that are impor-
tant for matching, which should be reÔ¨Çected in how atten-
tion is modeled and used for supervision.

Furthermore, such attention consistency should lead to
consistent feature representations for the two different im-
ages, leading to invariant representations for robust cross-
view matching. These considerations naturally suggest the
design of a Siamese framework that jointly learns consistent
attention regions for images of the same person while also
producing robust, invariant feature representations. While
one recent paper approached these problems jointly [38],
this method requires specially-designed architectures for at-
tention modeling and considers the attention in each image
independently, ignoring the intuition that attentive regions
across images of the same person have to be consistent. It
also does not have an explicit mechanism to explain the rea-
soning behind the model‚Äôs prediction. To this end, we de-
sign and propose a new deep architecture for re-id, which
we call the Consistent Attentive Siamese Network (CASN),
addressing all the key questions and considerations dis-
cussed above (Figure 1). SpeciÔ¨Åcally, we design a novel
two-branch architecture that (a) produces attentive regions
during training without requiring any additional supervision
other than identity labels or any specially-designed architec-
ture for modeling attention, (b) explicitly enforces these at-
tentive regions to be consistent for the same person, (c) uses
attention and attention consistency as an explicit and princi-
pled part of the learning process, and (d) learns to produce
robust representations for cross-view matching.
To summarize, our key contributions include:

‚Ä¢ We present a technique that makes spatial localization
of the person of interest a principled part of the learn-
ing process, providing supervision only by means of
person identity labels. This makes spatial localization
end-to-end trainable and automatically discovers com-
plete attentive regions.

‚Ä¢ We present a new scheme that enforces attention con-
sistency as part of the learning process, providing su-
pervision that facilitates end-to-end learning of consis-
tent attentive regions of images of the same person.

‚Ä¢ We present the Ô¨Årst learning architecture that integrates
attention consistency and Siamese learning in a joint
learning framework.

‚Ä¢ We present the Ô¨Årst Siamese attention mechanism that
jointly models consistent attention across similar im-
ages, resulting in a powerful method that can help ex-
plain the reasoning behind the network‚Äôs prediction.

2. Related Work

Traditional person re-id algorithms involved hand-
crafted feature design followed by supervised distance met-

ric learning. See Karanam et al. [15] and Zheng et al. [45]
for detailed experimental and algorithmic studies.

Recent developments in deep learning [11, 12] have in-
Ô¨Çuenced the design of re-id algorithms as well, with deep
re-id algorithms achieving impressive performance on chal-
lenging datasets [5, 32, 34]. However, naive training of re-
id models without being spatial-localization-aware will not
result in satisfactory performance due to cross-view mis-
alignment, occlusions, and clutter. To get around these is-
sues, several recent methods adopt some form of localized
representation learning. Zhao et al. [43] decomposed per-
son images into different part regions and learned region-
speciÔ¨Åc representations followed by an aggregation scheme
to produce the overall image representation. Li et al. [17]
proposed to Ô¨Årst learn and localize part body features by
means of spatial transformer networks [14], followed by a
combination of local and global features to learn a classiÔ¨Å-
cation network. Su et al. [31] used human pose information
as a supervisory signal to learn normalized human part rep-
resentations as part of an identiÔ¨Åcation network. However,
these and several other recent methods [18] consider the
spatial localization problem in itself and produce represen-
tations and localizations that are not cross-view consistent.
On the other hand, our approach tackles spatial localization
and representation learning in a holistic, joint framework
while enforcing consistency, which is key to re-id.

Attention has been used in re-id to tackle localization
and misalignment problems. Liu et al. [24] proposed the
HydraPlus-Net architecture that learns to discover low- and
semantic-level attentive features for richer image represen-
tations. Li et al. [21] designed a scheme to simultane-
ously learn ‚Äúhard‚Äù region-level and ‚Äúsoft‚Äù pixel-level at-
tentive features for a multi-granular feature representation.
Li et al. [19] learned multiple, predeÔ¨Åned attention models
and showed that each model corresponds to a speciÔ¨Åc body
part, the outputs of which are then aggregated by means of a
temporal attention model. These methods typically have in-
Ô¨Çexible region-speciÔ¨Åc attention models as part of the over-
all framework to learn important regions in the image, and
more importantly, do not have an explicit mechanism to en-
force attention consistency. Our approach is markedly dif-
ferent from these and other methods [30, 40] in this category
in that we only need image-level labels to learn attention,
while also enforcing attention consistency by making it a
principled part of the learning process.

Consistency is an important aspect of re-id to account for
cross-view differences. While this has been studied under
the term ‚Äúequivariance‚Äù in some prior work [16], for re-id,
it has been reÔ¨Çected in Siamese-like designs that attempt
to learn invariant feature representations [7, 8, 20, 28, 42].
These models learn features and distance metrics jointly
and do not address the spatial localization problem directly,
typically formulating a local parts-based approach to solve

5736

the problem. In scenarios involving occlusion and clutter,
this may not be an optimal solution, with attention leading
to better spatial localization. To this end, our method, as
opposed to these approaches, exploits attention during the
learning process while also learning consistent spatial lo-
calization and invariant feature representations jointly.

3. The Consistent Attentive Siamese Network

In this section, we introduce our proposed attention-
based deep architecture for person re-id, the Consistent At-
tentive Siamese Network (CASN), summarized in Figure
2. CASN includes an identiÔ¨Åcation module and a Siamese
module that provide for a powerful, Ô¨Çexible approach to
deal with viewpoint variations, occlusions, and background
clutter. The identiÔ¨Åcation module (Section 3.1), with its ex-
plicit attention guidance as supervision given only identity
labels, helps Ô¨Ånd reliable and accurate spatial localization
for the person of interest in the image and performs identity
(ID) prediction. The Siamese module (Section 3.2) provides
the network with supervisory signals from attention consis-
tency, ensuring that we obtain spatially consistent attention
regions for images of the same person, as well as learn-
ing view-invariant feature representations for robust gallery
matching. In the following, we describe each of these two
modules in more detail, leading up to the overall design of
the CASN.

3.1.1 The IDE Baseline Architecture

The IDE baseline is based on the ResNet50 architecture
[11], following the work in [45] and recent papers that adopt
ResNet50 [19, 34, 36]. Convolutional layers from conv1
through conv5 are pretrained on ImageNet [10], following
which an IDE classiÔ¨Åer comprised of two fully-connected
layers produces the identity prediction for the input image.
The identiÔ¨Åcation baseline is visually summarized in Fig-
ure 3. Note that while Figure 3 shows the IDE architecture
[45], this can be easily swapped with any other baseline ar-
chitecture that can give the feature vector f . For instance,
to use the part-based convolutional baseline (PCB) archi-
tecture [34], one would simply swap the ‚ÄúFeature Extrac-
tion‚Äù block in Figure 3 with PCB‚Äôs backbone prior to ob-
taining f . PCB is a modiÔ¨Åcation of IDE that replaces the
global average pooling operation in IDE with spatial pool-
ing for discriminative part-informed feature learning. The
baseline model is learned by optimizing the identiÔ¨Åcation
loss, which essentially maximizes the likelihood of predict-
ing the correct class (identity) label for each training im-
age. Formally, given N training images {In}N
n=1 belonging
to C different identities, with each image having an iden-
tity label {cn}N
n=1 ‚àà {1, ..., C}, we optimize the following
multi-class cross-entropy loss:

Lide = ‚àí

log

N

Xn=1

exp(ycn )

Pj exp(yj)

(1)

where ycn is the prediction of class cn from the IDE classi-
Ô¨Åer for input image In.

Figure 2: The Consistent Attentive Siamese Network.

3.1. The IdentiÔ¨Åcation Module

Figure 3: The baseline. f is the feature vector after
Resnet50 conv5, y is the ID prediction vector with dimen-
sionality equal to the total number of training identities, and
yc is the prediction score of ID label c for the input image.
Note that the ‚ÄúFeature extraction‚Äù block here can come from
any baseline architecture, e.g., IDE or PCB [34].

We Ô¨Årst introduce the architecture of the identiÔ¨Åcation
module of the CASN. We begin by describing the baseline
architecture for training an identiÔ¨Åcation (IDE) model [45],
followed by the overall identiÔ¨Åcation module that integrates
attention guidance into the IDE architecture.

3.1.2

IdentiÔ¨Åcation Attention

Spatial localization of the person of interest is a key Ô¨Årst
step for a re-id algorithm, which should be reÔ¨Çected in the
end-to-end learning process. While much recent work has

5737

‚ãØFeature mapsconv1Feature mapsconv5Resnet50 (pretrained)FCFCIDEClassifierùíáIdentification BaselineùíöùêºFeature Extractionùë¶ùëêfocused on generating attention regions given image-level
labels [9, 25, 27, 49], we need to make attention an explicit
part of the learning process itself, which can then guide the
network to better localize the person of interest.

To this end, we adopt the framework of Li et al. [18]
and introduce attention learning as part of our identiÔ¨Åcation
module, helping the network generate spatially attentive re-
gions in person images without needing any extra informa-
tion as supervision other than identity labels, which are al-
ready available.

Figure 4: An attention
map with identiÔ¨Åcation
loss (left) and identiÔ¨Åca-
tion loss with attention
learning (right).

Given an input image In
with its identity label cn,
we Ô¨Årst obtain the atten-
tion (localization) map from
the IDE classiÔ¨Åer predic-
tion by means of Grad-CAM
[27]. However, a re-id model
trained only with IDE loss
would focus only on the
most discriminative regions
important for satisfying the
current classiÔ¨Åcation objec-
tive, and may not generalize
well. To better illustrate this
concept, consider the Grad-
CAM attention map example shown in Figure 4 (left) for an
image from Market1501 [44]. The gray pants of the per-
son attract the most attention, but the blue jacket is also
useful information that is ignored in the attention map on
the left. To obtain more complete attention maps and fo-
cus on the foreground subject, we use the notion of at-
tention learning. SpeciÔ¨Åcally, given In and cn, we com-
pute its attention map Mn and mask out the most discrim-
inative regions in In (corresponding to high responses in
Mn) by means of the soft-masking operation Œ£(¬∑ ) to get
In = In ‚àó (1 ‚àí Œ£(Mn)), where ‚àó is pixel-wise multipli-
cation and Œ£(¬∑ ) = sigmoid(Œ±(Mn ‚àí Œ≤)). This produces
an In that excludes all high-response image pixels. If Mn
perfectly spatially localizes the person of interest, In will
contain no pixels contributing to the corresponding identity
prediction ycn . We use this notion to provide supervision to
the identiÔ¨Åcation module to produce more complete spatial
localization. SpeciÔ¨Åcally, we deÔ¨Åne the identiÔ¨Åcation atten-
tion loss Lia for the identiÔ¨Åcation module as the prediction
score of masked input image In:

Lia = ycn

(2)

A comparison of the attention maps retrieved from a model
trained only with the identiÔ¨Åcation loss and one with iden-
tiÔ¨Åcation loss and attention learning is shown in Figure 4,
where we see more foreground subject coverage with atten-
tion learning on the right. To summarize, in the identiÔ¨Åca-

tion module, we Ô¨Årst use the IDE baseline architecture to
obtain identity predictions. Attention maps are computed
with Grad-CAM and reÔ¨Åned using the identiÔ¨Åcation atten-
tion objective on masked images that exclude high-attention
regions to perform more complete spatial localization.

3.1.3 Discussion

While the IDE architecture can provide a good baseline
feature representation for matching [15, 36, 45] and our
proposed identiÔ¨Åcation module discussed above can fur-
ther lead to reasonable spatial localization by design, sev-
eral problems still remain unaddressed. First, the identiÔ¨Åca-
tion module has no mechanism to ensure we obtain con-
sistent attention regions for different images of the same
person. This can be inferred from the design itself, which
lacks any guiding principle to result in attention consis-
tency.
Intuitively, this is key to robust re-id since there
are typically common regions in different images of the
same person that need to be brought out as important dur-
ing matching. Second, the identiÔ¨Åcation module has no
mechanism to learn invariant identity-aware representations
across different camera views. Furthermore, attention con-
sistency should correspond to consistent feature representa-
tions, suggesting it should inform representation learning.
Finally, the attention component of the identiÔ¨Åcation mod-
ule is not particularly suitable during inference since we do
not know the identity of a test image to compute its atten-
tion map. While a workaround to this problem would be to
use the top-k predictions to compute attention, this clearly
would be a sub-optimal solution.

The problems with the identiÔ¨Åcation module lead us to
the design of the Siamese module of the CASN, which at-
tempts to address these issues in a principled manner.

3.2. The Siamese Module

In this section, we introduce the Siamese module to com-
plement the identiÔ¨Åcation module of the proposed CASN.
Given a pair of input images, we Ô¨Årst consider a binary clas-
siÔ¨Åcation problem (Section 3.2.1), whose objective func-
tion is then used to formulate a Siamese attention mech-
anism (Section 3.2.2) to enforce attention consistency and
consistency-aware invariant representation learning.

3.2.1 Binary ClassiÔ¨Åcation

Given a pair of input images, we construct a binary clas-
siÔ¨Åcation objective for predicting whether or not the pair
belongs to the same class. Given feature vectors f1 and f2
for the images I1 and I2 in the input pair (see Figure 3),
we compute the difference f ‚àí = f1 ‚àí f2, which forms
the input for a classiÔ¨Åer that uses the binary cross-entropy
objective (BCE) to get the class prediction for the current
input pair. Note that since we set out to compute attention

5738

in the spirit of GradCAM [27], we needed a classiÔ¨Åcation
objective to compute Siamese attention described next, and
we chose BCE for this purpose. The BCE classiÔ¨Åer is struc-
turally similar to the IDE classiÔ¨Åer in Section 3.1.1, with
two fully connected layers. The output prediction vector z
of the BCE classiÔ¨Åer is a 2-dimensional vector, which in-
dicates whether or not the input pair belongs to the same
identity. The BCE classiÔ¨Åcation objective that is optimized
is deÔ¨Åned, for a batch of P input pairs, as:

part. To provide an explicit attention-consistency-aware su-
pervisory signal and guide the network to discover consis-
tent cross-view importance regions, we introduce the notion
of spatial attention constraints based on the attention maps
derived from the BCE classiÔ¨Åcation objective.

log 

exp(z0) + exp(z1)!

exp(cid:0)zcp(cid:1)

(3)

(a)

(b)

(c)

Lbce = ‚àíXp

cp ‚àà {0, 1}, p = 1, . . . , P

where zcp is the same (cp = 1) or different (cp = 0) identity
prediction of the BCE classiÔ¨Åer for input pair p.

3.2.2 The Siamese Attention Mechanism

As discussed previously, identiÔ¨Åcation attention alone does
not ensure attention consistency and identity-aware invari-
ant representations. To this end, we propose a new Siamese
attention mechanism with explicit guidance towards atten-
tion consistency. Consider two images I1 and I2 of the same
identity and the corresponding BCE classiÔ¨Åer prediction z1.
We Ô¨Årst localize the attentive regions in the two images that
contribute to this BCE prediction. To this end, we compute
the gradient of the prediction score with respect to the fea-
ture vector f ‚àí, i.e., ‚àÇz1
‚àÇf ‚àí . We then Ô¨Ånd the features in f ‚àí
that have a positive inÔ¨Çuence on the Ô¨Ånal BCE prediction by
means of an indicator vector Œ± constructed as:

Œ±i =(1,

0,

if ‚àÇz1
‚àÇf ‚àí

i

> 0

otherwise

, i = {0, ..., dim(f ‚àí)}

(4)

‚àÇA1(cid:17) and Œ±k

Based on the indicator vector Œ±, the importance scores
for the input feature vectors f1 and f2 can be calculated as
the dot products of Œ± and the feature vectors: s1 = (Œ±, f1)
and s2 = (Œ±, f2). In the same spirit as Grad-CAM [27],
gradients backpropagated from s1 and s2 are Ô¨Årst glob-
ally average-pooled to Ô¨Ånd the channel importance weights
Œ±k
A2 are feature maps of image I1 and I2 at the last convo-
lutional layer. The attention maps can then be computed as

2 = GAP(cid:16) ‚àÇs2
1(cid:1) and M2 = ReLU(cid:0)Pk Œ±k

‚àÇA2(cid:17), where A1 and
2(cid:1).

1 = GAP(cid:16) ‚àÇs1
M1 = ReLU(cid:0)Pk Œ±k

Visualizations of the attention maps, extracted from the
BCE loss, are shown in Figure 5. For images of the same
person, we want the attention maps M1 and M2 to provide
consistent importance to corresponding regions in the im-
ages. For instance, as we can see in Figure 5(b), the atten-
tion map in Image 1 focuses on the full body of the per-
son while the one in Image 2 mostly focuses on the lower

2 Ak

1 Ak

(d)

(e)

(f)

Figure 5: Demonstration of attention maps from BCE loss.
(a-c): positive pairs, (d-f): negative pairs.

Given the attention maps M1 and M2, we Ô¨Årst apply
the max-pooling operation to compute the highest response
across each horizontal row of pixels, giving us the two im-
portance vectors Mm1 and Mm2. To enforce attention con-
sistency, we explicitly constrain them to be as close as pos-
sible. To avoid alignment issues as in Figure 5(c), we Ô¨Ånd
the Ô¨Årst and the last element of the vertical vector larger
than a certain threshold t in Mm1 and Mm2, and then re-
size the remaining elements to be of the same dimensions.
We deÔ¨Åne the Siamese attention loss that enforces attention
consistency as:

Lsa = Lbce + Œ±kM ‚àó

m1 ‚àí M ‚àó

m2k2

(5)

where Lbce is deÔ¨Åned in Equation 3, M ‚àó
m2 are
m1 ‚àí
resized vectors of Mm1 and Mm2 after alignment, kM ‚àó
M ‚àó
m2, and Œ± is
a weight parameter controlling the importance of the BCE
loss vis-a-vis the spatial attention constraints.

m2k2 is the l2 distance between M ‚àó

m1 and M ‚àó

m1 and M ‚àó

A visual summary of our proposed Siamese attention
mechanism is shown in Figure 6. For input pairs belonging
to the same identity, attention maps are retrieved from the
BCE classiÔ¨Åer predictions, following which they are max-
pooled to gather localization statistics for enforcing spatial
attention consistency.

3.3. Overall Design of the CASN

With the identiÔ¨Åcation and Siamese modules discussed
in the previous sections, we now present our overall frame-
work that integrates these two modules. Our proposed
CASN, depicted in Figure 2, is a two-branch architecture.
During training, we pass as input a pair of images belong-
ing either to the same or different identity. After feature

5739

Figure 6: Demonstration of the Siamese Attention Mechanism. Yellow arrows denote backward operation and green arrows
denote forward operation. The BCE loss Lbce and spatial constraints are added as Siamese Attention loss Lsa. Note that the
‚ÄúFeature extraction‚Äù block here can come from any baseline architecture, e.g., IDE or PCB.

extraction (see Figure 3), the feature vectors are input to the
identiÔ¨Åcation module and Siamese module separately.
In
the identiÔ¨Åcation module, the feature vectors are Ô¨Årst passed
to the IDE classiÔ¨Åer for identity classiÔ¨Åcation, following
which an attention map for the input image in the current
branch is retrieved from its identity label. The identiÔ¨Åcation
attention loss then guides the identiÔ¨Åcation module to dis-
cover complete attention regions for the input image. The
Siamese module takes as input the element-wise subtrac-
tion of the feature vectors from two branches, which is then
input to the BCE ClassiÔ¨Åer to retrieve the image-pair atten-
tion maps from the BCE loss. Given this, we enforce the
spatial constraint objective to ensure spatial consistency of
attentive regions across the two images in the input pair.

We optimize our proposed CASN for all the objectives
described here jointly, with the overall CASN training ob-
jective given as:

L = Lide + Œª1Lia + Œª2Lsa

(6)

where Lide is the IDE classiÔ¨Åcation loss, Lia is the iden-
tiÔ¨Åcation attention loss, and Lsa is the Siamese attention
loss. Note that the feature extraction blocks across the two
branches in Figure 2 share weights. The proposed CASN
addresses all problems discussed previously in a principled
fashion, allowing us to (a) generate attention maps with at-
tention consistency, (b) learn identity-aware invariant rep-
resentations by design, and (c) use attention maps during
inference for identities not seen during training. Further-
more, compared to existing attention mechanisms employed
in person re-id, our framework is Ô¨Çexible by design in that
it can be used in conjunction with any base architecture or
baseline re-id algorithm. For instance, in Section 4, we
show performance improvements with both the IDE [39]
and the PCB [34] baselines. Furthermore, we only need
identity labels during training (which are used by compet-
ing algorithms as well), but crucially, do not need any spe-
cially designed architecture sub-modules to make attention
a part of the learning process.

4. Experiments and Results

Datasets. We use Market-1501 [44], CUHK03-NP [20, 48],
and DukeMTMC-ReID [26, 46]. Market-1501 [44] collects
person images from 6 camera views, containing 12,936
training images with 751 different identities. Gallery and
query sets have 19,732 and 3,368 images respectively with
750 different identities. CUHK03-NP is a new training-
testing split protocol for CUHK03 [20], Ô¨Årst proposed in
[48], splitting the training and testing sets into 767 and 700
identities. DukeMTMC-ReID [46] is an image-based re-
id dataset generated from DukeMTMC [26] that randomly
splits training and testing sets equally into 702 identities.
Implementation Details. We resize all
images to
288√ó144, use SGD with momentum of 0.9, learning rate
of 0.03, and a total of 40 epochs, with the learning rate de-
creased by a factor of 10 at epoch 30. The parameter Œ± in
Equation 5 is set to 0.2, and Œª1 and Œª2 in Equation 6 are
set to 0.5 and 0.05 respectively. For the PCB baseline, we
follow the same protocol as in [34] and resize images to
384√ó128. We set the batch size to 16, use two NVIDIA
GTX-1080Ti GPUs, and implement all code in Pytorch [1].
Evaluation Protocol. After training, we use query and
gallery as pair inputs to obtain attention maps from BCE
classiÔ¨Åer predictions. The l2 distance of the attention maps
(Equation 5 in Section 3.2.2) and l2 distance of the feature
vectors are normalized and summed for Ô¨Ånal ranking. We
report the rank-1 Cumulative Match Characteristic (CMC)
and mean average precision (mAP) results.

4.1. Comparison to the State of the Art

In Tables 1 and 2, we compare the performance of our
method with several recently proposed algorithms applied
to the CUHK03-NP, DukeMTMC-ReID, and Market-1501
datasets. Note that all our results are evaluations without re-
ranking [48] and the PCB [34] architecture as the backend.
CUHK03-NP. We report experimental results on both de-
tected and labeled person images. The new train-test split,
containing only around 7,300 training images,
is much

5740

more prone to overÔ¨Åtting when compared to the other
datasets. However, results show that our method surpasses
the state of the art substantially for rank-1 (+4.7%, +5.7%)
on detected and labeled sets respectively, demonstrating the
strong generalization ability of the CASN. More crucially,
compared to a recently proposed attention-based method,
HA-CNN [21], our CASN achieves 29.8% and 25.8% rank-
1 and mAP improvements (on detected sets) respectively.

Table 1: CUHK03-NP (detected and labeled).

BoW+XQDA [44]

Detected

Labeled

R-1

6.4%

mAP

6.4%

R-1

7.9%

mAP

7.3%

LOMO+XQDA [22]

12.8% 11.5% 14.8% 13.6%

IDE [45]

PAN [47]

DPFL [41]

21.3% 19.7% 22.2% 21.0%

36.3% 34.0% 36.9% 35.0%

40.7% 37.0% 43.0% 40.5%

HA-CNN [21]

41.7% 38.6% 44.4% 41.0%

MLFN [4]

DaRe+RE [37]

PCB+RPP [34]

MGN [36]

CASN (IDE)

CASN (PCB)

52.8% 47.8% 54.7% 49.2%

63.3% 59.0% 66.1% 61.6%

63.7% 57.5%

-

-

66.8% 66.0% 68.0% 67.4%

57.4% 50.7% 58.9% 52.2%

71.5% 64.4% 73.7% 68.0%

Table 2: DukeMTMC-ReID and Market-1501 (SQ).

BoW+KISSME [44]

LOMO+XQDA [22]

SVDNet [33]

HA-CNN [21]

DuATM [28]

PCB+RPP [34]

DNN CRF [6]

MGN [36]

CASN (IDE)

CASN (PCB)

DukeMTMC-ReID

Market-1501

R-1

25.1%

30.8%

76.7%

80.5%

81.8%

83.3%

84.9%

mAP

12.2%

17.0%

56.8%

63.8%

64.6%

69.2%

69.5%

R-1

mAP

44.4% 20.8%

43.8% 22.2%

82.3% 62.1%

91.2% 75.7%

91.4% 76.6%

93.8% 81.6%

-

-

88.7% 78.4% 95.7% 86.9%

84.5%

87.7%

67.0%

73.7%

92.0% 78.0%

94.4% 82.8%

DukeMTMC-ReID. We report competitive results in Ta-
ble 2. Again, compared to recently proposed attention-
based methods, HA-CNN [21] and DuATM [28], our CASN
achieves 7.2% and 5.9% rank-1 accuracy improvements and
9.9% and 9.1% mAP improvements respectively.
Market-1501. We report competitive results with CASN
in Table 2. However, compared to recently proposed
attention-based methods, e.g., HA-CNN [21] and DuATM
[28] (shown in the table), and CAN [23] (R-1: 60.3%,
mAP: 35.9%), HPN [24] (R-1: 76.9%), MSCAN [17] (R-
1: 80.3%, mAP: 57.5%) our method produces much higher
results with both rank-1 and mAP.

As can be noted from these results, the proposed CASN

substantially outperforms existing attention-based meth-
ods for re-id. More importantly, unlike these competing
attention-based methods, CASN does not require any spe-
cially designed deep architecture for modeling attention,
relying only on identity labels for supervision. This al-
lows the CASN to be highly Ô¨Çexible for use in conjunc-
tion with any baseline CNN architecture, such as VGGNet
[29], DenseNet [12], or SqueezeNet [13]. For instance, with
DenseNet and the IDE baseline, CASN achieves a rank-1
and mAP performance of 57.2% and 52.0% respectively on
CUHK03-NP (detected), which are close to CASN‚Äôs results
with ResNet50 and IDE, discussed next.

4.2. Ablation Study and Discussion

In this section, we further study the role of the identiÔ¨Åca-
tion attention and Siamese attention mechanisms individu-
ally, and how they inÔ¨Çuence the performance of the CASN.
In Table 3, we report evaluation results of our proposed
model on CUHK03-NP (detected), DukeMTMC-ReID and
Market-1501, starting from baseline IDE and PCB archi-
tectures and working up to the full CASN model. From
Table 3, we can see clear performance improvements over
the baseline with individual attention modules. For instance
on CUHK03-NP, IDE+IA improves the rank-1 and mAP
performance of baseline IDE by 9.0% and 9.2% whereas
IDE+SA improves the rank-1 accuracy by 9.4% and 10.2%
respectively. This provides evidence for our initial hypoth-
esis that spatial localization, via end-to-end trainable atten-
tion mechanisms, should be an important and integral part
of the framework design. Furthermore, adding both atten-
tion modules improves performance as measured by both
rank-1 accuracy and mAP, demonstrating the importance of
using both identiÔ¨Åcation and Siamese modules.

Table 3: Ablation study. IA: IdentiÔ¨Åcation Attention, SA:
Siamese Attention, SQ: Single-Query.

Loss type

CUHK03-NP

DukeMTMC-ReID Market-1501 (SQ)

R-1

mAP

R-1

IDE [34]

IDE + IA

43.8% 38.9% 73.2%

54.8% 48.1% 83.2%

IDE + SA

55.2% 49.1% 83.5%

mAP

52.8%

66.0%

66.0%

R-1

85.3%

91.0%

91.6%

mAP

68.5%

76.9%

77.7%

CASN(IDE) 57.4% 50.7% 84.5% 67.0% 92.0% 78.0%

PCB [34]

61.3% 54.2% 81.7%

PCB + IA

68.5% 62.4% 87.3%

PCB + SA

69.9% 64.2% 86.8%

66.1%

73.4%

73.5%

92.4%

93.9%

94.1%

77.3%

81.8%

82.6%

CASN(PCB) 71.5% 64.4% 87.7% 73.7% 94.4% 82.8%

Comparisons of the attention maps acquired from the
models trained with BCE loss and BCE loss with Siamese
Attention loss are shown in Figure 7(a-b). Clearly, with
the proposed Siamese attention mechanism, we obtain more
consistent attention maps of the same person image pair in
Figure 7(b) compared to Figure 7(a). Furthermore, we also
demonstrate these attention maps for the testing image pairs

5741

(a) Attention maps retrieved from BCE loss (training)

(b) Attention maps retrieved from BCE loss with Siamese Attention loss (training)

(c) Attention maps retrieved from model trained with Siamese Attention (Rank 1 gallery match for query images)

Figure 7: Demonstrating the efÔ¨Åcacy of the proposed Siamese attention by means of attention maps for same-person images.

in Figure 7(c), where we again see attention consistency
among the query and retrieved gallery images. These exam-
ples demonstrate the effectiveness of our proposed Siamese
attention mechanism, and also provide a powerful inter-
pretability tool. With such attention maps, we can now
explain why our Siamese network predicts a certain input
image pair to be similar or dissimilar, leading to intuitive
explanations for person re-id. In more detail, Figure 8(a)
shows two query images (one on each row), along with their
rank-1 (left column) and ground-truth matches (right col-
umn). Each rank-1 match is a wrong match (failure case)
while the ground-truth has a lower rank, and we can un-
derstand the reasoning from our attention maps. For in-
stance, on the Ô¨Årst row, we see reasonable attention con-
sistency between the query and rank-1 (notice both show
women in dresses), explaining why the wrong match was
ranked 1, unlike the ground-truth, where we see attention
focused on different regions, leading to lower rank (rank 3
in this example). In Fig 8(b), we demonstrate the efÔ¨Åcacy of
our proposed Siamese attention (two examples, one on each
row). The left column shows {query, ground-truth} and the
ground truth‚Äôs rank without Siamese attention. The right
column shows these results with Siamese attention. We can
see that Siamese attention results in better attention consis-
tency, which is also reÔ¨Çected in the improved rank.

5. Conclusions

We proposed the Ô¨Årst learning architecture that integrates
attention consistency modeling and Siamese representation
learning in a joint learning framework, called the Consistent
Attentive Siamese Network (CASN), for person re-id. Our
framework provides for principled supervisory signals that
guide our model towards discovering consistent attentive re-
gions for same-identity images while also learning identity-
aware invariant representations for cross-view matching.
We conducted extensive evaluations on three popular person

Figure 8: (a) Our attention maps can explain wrong (high
rank, e.g., rank 1) and ground-truth matches (low rank, e.g.,
rank 3).
(b) Siamese attention gives rank improvements,
providing reasoning with attention consistency.

re-id datasets and demonstrated competitive performance.
While computing attention as in Section 3.2.2 is speciÔ¨Åc
to standing poses that are common in existing benchmarks,
our framework is extensible to enforce different kinds of
consistency given data- or domain-speciÔ¨Åc priors for real-
world generalizability.

Acknowledgements This material is based upon work
supported by the U.S. Department of Homeland Security
under Award Number 2013-ST-061-ED0001. The views
and conclusions contained in this document are those of the
authors and should not be interpreted as necessarily repre-
senting the ofÔ¨Åcial policies, either expressed or implied, of
the U.S. Department of Homeland Security.

5742

References

[1] Pytorch. https://pytorch.org/.
[2] Jacob Andreas, Marcus Rohrbach, Trevor Darrell, and Dan

Klein. Neural module networks. In CVPR, 2016.

[3] Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio.
Neural machine translation by jointly learning to align and
translate. In ICLR, 2015.

[4] Xiaobin Chang, Timothy M. Hospedales, and Tao Xiang.
Multi-level factorisation net for person re-identiÔ¨Åcation. In
CVPR, 2018.

[5] Dapeng Chen, Hongsheng Li, Xihui Liu, Yantao Shen, Ze-
jian Yuan, and Xiaogang Wang. Improving deep visual rep-
resentation for person re-identiÔ¨Åcation by global and local
image-language association. In ECCV, 2018.

[6] Dapeng Chen, Dan Xu, Hongsheng Li, Nicu Sebe, and Xi-
aogang Wang. Group consistent similarity learning via deep
CRF for person re-identiÔ¨Åcation. In CVPR, 2018.

[7] Weihua Chen, Xiaotang Chen, Jianguo Zhang, and Kaiqi
Huang. Beyond triplet loss: A deep quadruplet network for
person re-identiÔ¨Åcation. In CVPR, 2017.

[8] De Cheng, Yihong Gong, Sanping Zhou, Jinjun Wang, and
Nanning Zheng. Person re-identiÔ¨Åcation by multi-channel
parts-based CNN with improved triplet loss function.
In
CVPR, 2016.

[9] Ramazan Gokberk Cinbis, Jakob Verbeek, and Cordelia
Schmid. Weakly supervised object localization with multi-
fold multiple instance learning. IEEE Transactions on Pat-
tern Analysis and Machine Intelligence, Jan 2017.

[10] Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and
ImageNet: A Large-Scale Hierarchical Image

Li Fei-Fei.
Database. In CVPR, 2009.

[11] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
In CVPR,

Deep residual learning for image recognition.
2016.

[12] Gao Huang, Zhuang Liu, Laurens van der Maaten, and Kil-
ian Q Weinberger. Densely connected convolutional net-
works. In CVPR, 2017.

[13] Forrest N. Iandola, Song Han, Matthew W. Moskewicz,
Khalid Ashraf, William J. Dally, and Kurt Keutzer.
Squeezenet: Alexnet-level accuracy with 50x fewer parame-
ters and <0.5mb model size. arXiv:1602.07360, 2016.

[14] Max Jaderberg, Karen Simonyan, Andrew Zisserman, and
Koray Kavukcuoglu. Spatial transformer networks. In NIPS.
2015.

[15] Srikrishna Karanam, Mengran Gou, Ziyan Wu, Angels
Rates-Borras, Octavia Camps, and Richard J. Radke. A
Systematic Evaluation and Benchmark for Person Re-
IdentiÔ¨Åcation: Features, Metrics, and Datasets.
IEEE
Transactions on Pattern Analysis and Machine Intelligence,
41:523‚Äì536, Mar. 2019.

[16] Karel Lenc and Andrea Vedaldi. Learning covariant feature

detectors. In ECCVW, 2016.

[17] Dangwei Li, Xiaotang Chen, Zhang Zhang, and Kaiqi
Huang. Learning deep context-aware features over body and
latent parts for person re-identiÔ¨Åcation. In CVPR, 2017.

[18] Kunpeng Li, Ziyan Wu, Kuan-Chuan Peng, Jan Ernst, and
Yun Fu. Tell me where to look: Guided attention inference
network. In CVPR, 2018.

[19] Shuang Li, Slawomir Bak, Peter Carr, and Xiaogang Wang.

Diversity regularized spatiotemporal attention for video-
based person re-identiÔ¨Åcation. In CVPR, 2018.

[20] Wei Li, Rui Zhao, Tong Xiao, and Xiaogang Wang. Deep-
reid: Deep Ô¨Ålter pairing neural network for person re-
identiÔ¨Åcation. In CVPR, 2014.

[21] Wei Li, Xiatian Zhu, and Shaogang Gong. Harmonious at-
tention network for person re-identiÔ¨Åcation. In CVPR, 2018.
[22] Shengcai Liao, Yang Hu, Xiangyu Zhu, and Stan Z. Li. Per-
son re-identiÔ¨Åcation by local maximal occurrence represen-
tation and metric learning. In CVPR, 2015.

[23] Hao Liu, Jiashi Feng, Meibin Qi, Jianguo Jiang, and
Shuicheng Yan. End-to-end comparative attention networks
for person re-identiÔ¨Åcation.
IEEE Transactions on Image
Processing, July 2017.

[24] Xihui Liu, Haiyu Zhao, Maoqing Tian, Lu Sheng, Jing Shao,
Junjie Yan, and Xiaogang Wang. Hydraplus-net: Attentive
deep features for pedestrian analysis. In ICCV, 2017.

[25] Maxime Oquab, Leon Bottou, Ivan Laptev, and Josef Sivic.
Is object localization for free? - weakly-supervised learning
with convolutional neural networks. In CVPR, 2015.

[26] Ergys Ristani, Francesco Solera, Roger Zou, Rita Cucchiara,
and Carlo Tomasi. Performance measures and a data set for
multi-target, multi-camera tracking. In ECCV, 2016.

[27] Ramprasaath R. Selvaraju, Michael Cogswell, Abhishek
Das, Ramakrishna Vedantam, Devi Parikh, and Dhruv Ba-
tra. Grad-cam: Visual explanations from deep networks via
gradient-based localization. In ICCV, 2017.

[28] Jianlou Si, Honggang Zhang, Chun-Guang Li, Jason Kuen,
Xiangfei Kong, Alex ChiChung Kot, and Gang Wang. Dual
attention matching network for context-aware feature se-
quence based person re-identiÔ¨Åcation. In CVPR, 2018.

[29] Karen Simonyan and Andrew Zisserman. Very deep convo-
lutional networks for large-scale image recognition. In ICLR,
2015.

[30] Chunfeng Song, Yan Huang, Wanli Ouyang, and Liang
Wang. Mask-guided contrastive attention model for person
re-identiÔ¨Åcation. In CVPR, pages 1179‚Äì1188, 2018.

[31] Chi Su, Jianing Li, Shiliang Zhang, Junliang Xing, Wen Gao,
and Qi Tian. Pose-driven deep convolutional model for per-
son re-identiÔ¨Åcation. In ICCV, 2017.

[32] Yumin Suh, Jingdong Wang, Siyu Tang, Tao Mei, and Ky-
oung Mu Lee. Part-aligned bilinear representations for per-
son re-identiÔ¨Åcation. In ECCV, 2018.

[33] Yifan Sun, Liang Zheng, Weijian Deng, and Shengjin Wang.

SVDNet for pedestrian retrieval. In ICCV, 2017.

[34] Yifan Sun, Liang Zheng, Yi Yang, Qi Tian, and Shengjin
Wang. Beyond part models: Person retrieval with reÔ¨Åned
part pooling (and a strong convolutional baseline). In ECCV,
2018.

[35] Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszko-
reit, Llion Jones, Aidan N Gomez, ≈Åukasz Kaiser, and Illia
Polosukhin. Attention is all you need. In NIPS, 2017.

[36] Guanshuo Wang, Yufeng Yuan, Xiong Chen, Jiwei Li, and Xi
Zhou. Learning Discriminative Features with Multiple Gran-
ularities for Person Re-IdentiÔ¨Åcation. In ACM MM, 2018.

[37] Yan Wang, Lequn Wang, Yurong You, Xu Zou, Vincent
Chen, Serena Li, Gao Huang, Bharath Hariharan, and Kil-
ian Q. Weinberger. Resource aware person re-identiÔ¨Åcation
across multiple resolutions. In CVPR, 2018.

[38] Lin Wu, Yang Wang, Junbin Gao, and Xue Li. Where-and-

5743

when to look: Deep Siamese attention networks for video-
based person re-identiÔ¨Åcation. IEEE Transactions on Multi-
media, 2018.

[39] Tong Xiao, Hongsheng Li, Wanli Ouyang, and Xiaogang
Wang. Learning deep feature representations with domain
guided dropout for person re-identiÔ¨Åcation. In CVPR, 2016.
[40] Jing Xu, Rui Zhao, Feng Zhu, Huaming Wang, and Wanli
Ouyang. Attention-aware compositional network for person
re-identiÔ¨Åcation. In CVPR, 2018.

[41] Xiatian Zhu Yanbei Chen and Shaogang Gong. Person re-
identiÔ¨Åcation by deep learning multi-scale representations.
In ICCVW, 2017.

[42] Hongsheng Li Yantao Shen, Shuai Yi, Dapeng Chen, and Xi-
aogang Wang. Person re-identiÔ¨Åcation with deep similarity-
guided graph neural network. In ECCV, 2018.

[43] Liming Zhao, Xi Li, Jingdong Wang, and Yueting Zhuang.
Deeply-learned part-aligned representations for person re-
identiÔ¨Åcation. In ICCV, 2017.

[44] Liang Zheng, Liyue Shen, Lu Tian, Shengjin Wang, Jing-
dong Wang, and Qi Tian. Scalable person re-identiÔ¨Åcation:
A benchmark. In ICCV, 2015.

[45] Liang Zheng, Yi Yang, and Alexander G. Hauptmann. Per-
son re-identiÔ¨Åcation: Past, present and future. ArXiv e-prints,
2016.

[46] Zhedong Zheng, Liang Zheng, and Yi Yang. Unlabeled sam-
ples generated by GAN improve the person re-identiÔ¨Åcation
baseline in vitro. In ICCV, 2017.

[47] Zhedong Zheng, Liang Zheng, and Yi Yang. Pedestrian
alignment network for large-scale person re-identiÔ¨Åcation.
IEEE Transactions on Circuits and Systems for Video Tech-
nology, 2018.

[48] Zhun Zhong, Liang Zheng, Donglin Cao, and Shaozi Li. Re-
ranking person re-identiÔ¨Åcation with k-reciprocal encoding.
In CVPR, 2017.

[49] Bolei Zhou, Aditya Khosla, Agata Lapedriza, Aude Oliva,
and Antonio Torralba. Learning deep features for discrimi-
native localization. In CVPR, 2016.

5744

