Variational Bayesian Dropout with a Hierarchical Prior

Yuhang Liu1

,

2, Wenyong Dong1, Lei Zhang3

,

2, Dong Gong2, and Qinfeng Shi2

1School of Computer Science, Wuhan University, Hubei, China

2The University of Adelaide, Australia

3Inception Institute of Artiï¬cial Intelligence, UAE

https://sites.google.com/view/yuhangliu/pro

Abstract

Variational dropout (VD) is a generalization of Gaus-
sian dropout, which aims at inferring the posterior of net-
work weights based on a log-uniform prior on them to learn
these weights as well as dropout rate simultaneously. The
log-uniform prior not only interprets the regularization ca-
pacity of Gaussian dropout in network training, but also
underpins the inference of such posterior. However, the
log-uniform prior is an improper prior (i.e., its integral is
inï¬nite), which causes the inference of posterior to be ill-
posed, thus restricting the regularization performance of
VD. To address this problem, we present a new general-
ization of Gaussian dropout, termed variational Bayesian
dropout (VBD), which turns to exploit a hierarchical pri-
or on the network weights and infer a new joint posterior.
Speciï¬cally, we implement the hierarchical prior as a zero-
mean Gaussian distribution with variance sampled from a
uniform hyper-prior. Then, we incorporate such a prior in-
to inferring the joint posterior over network weights and the
variance in the hierarchical prior, with which both the net-
work training and dropout rate estimation can be cast into
a joint optimization problem. More importantly, the hierar-
chical prior is a proper prior which enables the inference
of posterior to be well-posed. In addition, we further show
that the proposed VBD can be seamlessly applied to net-
work compression. Experiments on classiï¬cation and net-
work compression demonstrate the superior performance of
the proposed VBD in regularizing network training.

1. Introduction

Deep neural networks have gained great success in vari-
ous artiï¬cial intelligence research areas, e.g., computer vi-
sion [12, 8], natural language processing [4], etc. Never-
theless, due to the limited samples with annotation in prac-
tice, training deep neural networks with extensive parame-
ters often suffers from over-ï¬tting problem [35]. Dropout
proves to be a practical technique to alleviate this prob-
lem, which stochastically regularizes network weights by

(cid:55)(cid:75)(cid:72)(cid:3)(cid:79)(cid:82)(cid:74)(cid:3)(cid:88)(cid:81)(cid:76)(cid:73)(cid:82)(cid:85)(cid:80)(cid:3)

(cid:42)(cid:68)(cid:88)(cid:86)(cid:86)(cid:76)(cid:68)(cid:81)

(cid:56)(cid:81)(cid:76)(cid:73)(cid:82)(cid:85)(cid:80)(cid:3)

(cid:28)

(cid:58)

c

(cid:28)

(cid:58)

(cid:72)

(cid:57)(cid:68)(cid:85)(cid:76)(cid:68)(cid:87)(cid:76)(cid:82)(cid:81)(cid:68)(cid:79)(cid:3)(cid:71)(cid:85)(cid:82)(cid:83)(cid:82)(cid:88)(cid:87)
(cid:58) (cid:28)
(cid:12)
(cid:12)
(cid:76)
(cid:80)

p(cid:58)

(cid:11) (cid:11)
KLD q

(cid:12) (cid:95)(cid:95)

(cid:81)

(cid:11)

(cid:95)

(cid:57)(cid:68)(cid:85)(cid:76)(cid:68)(cid:87)(cid:76)(cid:82)(cid:81)(cid:68)(cid:79)(cid:3)(cid:37)(cid:68)(cid:92)(cid:72)(cid:86)(cid:76)(cid:68)(cid:81)(cid:3)(cid:71)(cid:85)(cid:82)(cid:83)(cid:82)(cid:88)(cid:87)

(cid:80)(cid:76)(cid:81)

(cid:11) (cid:11)
KLD q

(cid:58)

(cid:15)

(cid:72)

(cid:12) (cid:95)(cid:95)

(cid:11)

p

(cid:58) (cid:28)
(cid:12)(cid:12)

(cid:72)

(cid:15)

(cid:95)

a

b

Figure 1: Variational dropout v.s. the proposed variational
Bayesian dropout.

randomly enforcing multiplicative noise on input features
during training [13]. Over the past several years, various
dropout methods have been proposed [13, 29, 33]. Among
them, Gaussian dropout [33] provides a general framework,
which introduces the distribution of network weights into
model training and thus can well approximate the conven-
tional dropout with different types of noise, such as binary
noise [13] or Gaussian noise [29]. While these methods
have shown promising regularization performance in vari-
ous deep network architectures [20, 28, 16, 18, 9], the rea-
son behind such success is not clear, and their performance
heavily depends on a predeï¬ned dropout rate, for which tra-
ditional grid-search based methods is a prohibitive opera-
tion for large network models.

Variational dropout (VD) [19] is a generalization of
Gaussian dropout, which focuses on inferring the posteri-
or of network weights based on a log-uniform prior. By
doing this, VD can address these two aspects of the prob-
lems mentioned above. 1) Bayesian Interpretation. It has
been proved [19] that VD can be consistent with Gaus-
sian dropout for a ï¬xed dropout rate by enforcing the log-
uniform prior on network weights. This implies that incor-
porating Gaussian dropout into network training amounts to
variational inference on the network weights, where these
weights are regularized by the Kullback-Leibler (KL) di-
vergence between the variational posterior, i.e., the distri-
bution of network weights introduced by Gaussian dropout,
and the log-uniform prior. In other words, the log-uniform
prior endows Gaussian dropout with the regularization ca-
pacity. 2) Adaptive dropout rate. Based on the log-uniform
prior, VD [19] can simultaneously learn network weights
as well as dropout rate via inferring the posterior on these

17124

weights. To sum up, the log-uniform prior as the footstone
of VD underpins these two advantages above. However, re-
cent theoretical progress in [14, 15, 26] demonstrates that
the log-uniform prior is an improper prior (i.e., its integral
is inï¬nite), which causes inferring the posterior of network
weights to be ill-posed. Such ill-posed inference can degen-
erate variational inference on these weights into penalized
maximum likelihood estimation [14]. Thus, the interpreta-
tion of the regularization capacity of Gaussian dropout is
not in a full Bayesian way. And more importantly, the reg-
ularization capacity of VD is still limited.

To address this problem, we propose a variational
Bayesian dropout (VBD) framework, which is a new gen-
eralization of Gaussian dropout. A visual comparison be-
tween the proposed VBD and VD can be seen in Figure 1.
In VBD, we assume network weights to come from a two-
level hierarchical prior. Instead of only inferring the poste-
rior over network weights, we propose to infer the joint pos-
terior over both network weights and their hyper-parameters
deï¬ned in their ï¬rst-level prior. Through implementing the
hierarchical prior as a zero-mean Gaussian distribution with
variance sampled from a uniform distribution, we can the-
oretically prove that the proposed VBD can be consisten-
t with Gaussian dropout [33] for a ï¬xed dropout rate as
VD. Thus, VBD also can interpret the regularization ca-
pacity of Gaussian dropout.
In contrast to the improper
log-uniform prior, the proposed hierarchical prior is a prop-
er prior, which enables the inference of posterior in VBD
well-posed. This not only leads to a full Bayesian justi-
ï¬cation for Gaussian dropout, but also improves the regu-
larization capacity obviously. In addition, we further ï¬nd
that the proposed VBD can be seamlessly applied to neu-
ral network compression as [25, 26]. Experimental results
on classiï¬cation as well as network compression tasks show
the effectiveness of VBD in handling over-ï¬tting.

2. Related work

Dropout. Dropout plays an important role in improv-
ing the generalization capacity of deep neural networks. At
ï¬rst, dropout is employed to randomly drop input features
with Bernoulli distribution during training to prevent feature
co-adaptation [13]. This amounts to training an exponential
number of different networks with shared parameters.
In
the test phase, the prediction is determined by averaging the
outputs of all these different networks. The idea of dropout
is then generalized by multiplying the input features with
random noise drawn from other distributions, e.g., Gaus-
sian [29]. While these early methods have shown effective-
ness in some cases, repeatedly dropping a random subset
of input features makes training a network much slower.
To address this problem, Gaussian dropout [33] proposes
to sample the output features from a Gaussian distribution
instead of input features in dropout training and shows vir-

tually identical regularization performance but faster con-
vergence. This is inspired by the observation that enforcing
multiplicative noise on input features, whatever the noise
is generated from a Bernoulli distribution or a Gaussian,
making use of the central limit theorem, makes the corre-
sponding outputs to be approximately Gaussian [33]. How-
ever, these conventional dropout methods fail to clarify the
intrinsic principle for their regularization capacity. In ad-
dition, their performance depends a lot on the pre-deï¬ned
dropout rate. In contrast, the proposed VBD can provide a
Bayesian interpretation for dropout as well as automatically
estimating the dropout rate.

Variational Dropout. VD is a generalization of Gaus-
sian dropout, which can interpret the regularization capacity
of dropout as well as automatically estimating the dropout
rate via inferring the posterior of network weights. For ex-
ample, literature in [19] proves that training network with
variational dropout framework implicitly imposes the log-
uniform prior on weights for preventing over-ï¬tting. S-
ince the dropout rate can be automatically determined, some
works of literature [25, 26] further apply VD to compress
neural networks. However, the log-uniform prior is an im-
proper prior which causes the inference of posterior over
network weights in VD to be ill-posed [15, 26], thus limit-
ing its performance in preventing over-ï¬tting. In this study,
the proposed VBD imposes a proper hierarchical prior on
network weights, which induces a well-posed Bayesian in-
ference over network weights and thus improves the regu-
larization capacity.

Concrete Dropout and Adversarial Dropout. In addi-
tion, recent works have proposed another two dropout meth-
ods, e.g., concrete dropout [6] and adversarial dropout [27].
They are different from the proposed VBD. Speciï¬cal-
ly, concrete dropout provides Bayesian generalization for
dropout with Bernoulli distribution [13], while the pro-
posed VBD provides Bayesian generalization for Gaussian
dropout [33]. Besides, adversarial dropout [27] proposes to
handle over-ï¬tting by training the network in an adversarial
way. In contrast, the proposed method focuses on introduc-
ing hierarchical prior on network weights to regularize the
network training.

3. Preliminaries

Consider a supervised learning problem on a dataset
ğ’Ÿ = {(xğ‘–, yğ‘–)}ğ‘
ğ‘–=1 of observation-label pairs. We train a
fully connected neural network with ğ¿ hidden layers. For
each layer, we have:

B = Ağœƒ,

(1)

where A denotes the ğ‘€ Ã— ğ¾ matrix of input features for
current minibatch, ğœƒ is the ğ¾ Ã— ğ· weight matrix, B is the
ğ‘€ Ã— ğ· output matrix before activation function.

27125

3.1. Gaussian Dropout

To prevent over-ï¬tting, dropout applies multiplicative
noise on the input of each layer of neural networks during
training as follows:

B = (A âˆ˜ ğœ‰)ğœƒ,

(2)

where ğœ‰ is the ğ‘€ Ã— ğ¾ noisy matrix, and âˆ˜ denotes the
element-wise (Hadamard) product. In conventional dropout
methods, the elements of the noise ğœ‰ are either sampled
from a Bernoulli distribution with probability 1 à¢¤ ğ‘ of being
1, with the dropout rate ğ‘ [13], or sampled from a Gaussian
distribution with mean 1 and variance ğ›¼ = ğ‘/(1 à¢¤ ğ‘) [29].
Regardless which strategy of the above two is used, accord-
ing to the central limit theorem and equation Eq. (2), one
can directly produce ğµğ‘š,ğ‘‘ by sampling from the following
Gaussian distribution:

ğ‘(ğµğ‘š,ğ‘‘âˆ£A) = ğ’© (ğµğ‘š,ğ‘‘âˆ£ğœ‡ğ‘š,ğ‘‘, ğ›¿2

ğ‘š,ğ‘‘),

(3)

where mean ğœ‡ğ‘š,ğ‘‘ = âˆ‘ğ¾
ğ›¼ âˆ‘ğ¾
This means ğ‘(W) can be factorized as follows:

ğ‘š,ğ‘‘ =
ğ‘˜,ğ‘‘. Here ğ´ğ‘š,ğ‘˜ denotes an element in A.

ğ‘˜=1 ğ´ğ‘š,ğ‘˜ğœƒğ‘˜,ğ‘‘ and variance ğ›¿2

ğ‘˜=1 ğ´2

ğ‘š,ğ‘˜ğœƒ2

ğ‘(W) =

ğ¾

ğ·

âˆ

âˆ

ğ‘˜=1

ğ‘‘=1

ğ‘(ğ‘Šğ‘˜,ğ‘‘) =

ğ¾

ğ·

âˆ

âˆ

ğ‘˜=1

ğ‘‘=1

ğ’© (ğ‘Šğ‘˜,ğ‘‘âˆ£ğœƒğ‘˜,ğ‘‘, ğ›¼ğœƒ2

ğ‘˜,ğ‘‘),

(4)
where each element ğ‘Šğ‘˜,ğ‘‘ in W can be sampled from
ğ‘(Wğ‘˜,ğ‘‘) in Eq. (4). Finally, the objective function for net-
work training with Gaussian dropout becomes:

max

ğœƒ

ğ¿ğ’Ÿ(ğœƒ) â‰ƒ max

ğœƒ

ğ‘

âˆ‘

ğ‘–=1

ğ”¼

ğ‘(W)log ğ‘(yğ‘–âˆ£xğ‘–, W).

(5)

The viewpoint in Eq. (5) provides a opportunity to bridge
the gap between Bayesian inference and dropout, if we use
Eq. (4) as an approximate posterior distribution for a net-
work model with a special prior on the weights. The chal-
lenge in this gap is what is the special prior.

3.2. Variational Dropout

VD uses ğ‘(W) in Eq. (4) as a variational posterior to
approximate the true posterior ğ‘(Wâˆ£ğ’Ÿ) in terms of minimal
KL divergence,

min
ğœƒ,ğ›¼

ğ·ğ¾ğ¿(ğ‘(W)âˆ£âˆ£ğ‘(Wâˆ£ğ’Ÿ)).

(6)

Here ğ·ğ¾ğ¿() denotes the KL divergence. Given W
from a prior ğ‘(W), according to the Bayesian rule, i.e.,
ğ‘(Wâˆ£ğ’Ÿ) âˆ ğ‘(ğ’Ÿâˆ£W)ğ‘(W), minimizing the KL divergence
in Eq. (6) is equivalent to maximizing the variational lower
bound of the marginal likelihood of data as:

max
ğœƒ,ğ›¼

ğ¿ğ’Ÿ(ğœƒ, ğ›¼) à¢¤ ğ·ğ¾ğ¿(ğ‘(W)âˆ£âˆ£ğ‘(W)),

(7)

where ğ¿ğ’Ÿ(ğœƒ, ğ›¼) with ï¬xed parameter ğ›¼ is the same as one
in Eq. (5) and known as the expected log-likelihood term.

Firstly, in VD, the dropout rate ğ›¼ can be automatically
determined by data characteristics. Secondly, VD can pro-
vide a Bayesian interpretation for the success of dropout
in preventing over-ï¬tting. To clarify this, VD requires that
the optimization of ğœƒ in Eq. (7) is consistent with that in
Gaussian dropout in Eq. (5), i.e., maximizing the expect-
ed log-likelihood. To this end, the prior ğ‘(W) has to be
such that ğ·ğ¾ğ¿(ğ‘(W)âˆ£âˆ£ğ‘(W)) in Eq. (7) does not depend
on weight parameters ğœƒ. With such a requirement, we have
the following proposition.

Proposition 1 ([19]). The only prior in VD, which enables
ğ·ğ¾ğ¿(ğ‘(W)âˆ£âˆ£ğ‘(W)) not depending on weight parameters
ğœƒ, is the log-uniform prior:

ğ‘(âˆ£ğ‘Šğ‘˜,ğ‘‘âˆ£) =

ğ‘

âˆ£ğ‘Šğ‘˜,ğ‘‘âˆ£

â‡” ğ‘(log(âˆ£ğ‘Šğ‘˜,ğ‘‘âˆ£)) = ğ‘.

(8)

The above discussion demonstrates that training net-
work with VD implicitly imposes the log-uniform prior on
weights. With such a prior, the KL term in Eq. (7) is able
to regularize the number of signiï¬cant digits stored for the
weights W in the ï¬‚oating-point format, thus being able
to mitigate over-ï¬tting at some extent. However, the log-
uniform prior is an improper prior, which reaches ill-posed
variational inference, e.g., the KL divergence between the
variational posterior in Eq. (4) and the log uniform prior
in Eq. (8) is inï¬nite. Although leveraging truncated tech-
niques relieves this problem at some extent [19, 26], patho-
logical behaviour still remains [14], e.g., the resultant inï¬-
nite KL divergence theoretically degenerate VD into a max-
imum likelihood estimation that fails to avoid over-ï¬tting.
More details for the theoretical justiï¬cation can be found
in [15, 26, 14]. Therefore, the performance of VD in pre-
venting over-ï¬tting need to be further improved.

In this section, we will introduce the details of the pro-
posed VBD. In the following, we ï¬rst introduce the pro-
posed VBD framework. Then, we show a speciï¬cally
designed hierarchical prior in VBD framework and prove
that VBD with this prior can be consistent with Gaussian
dropout for a ï¬xed dropout rate.

3.3. Variational Bayesian Dropout

In contrast to a one-level prior in VD, we turn to propose
a two-level hierarchical prior ğ‘(W, ğ›¾) = ğ‘(Wâˆ£ğ›¾)ğ‘(ğ›¾).
This brings two aspects of advantages. Firstly, two kind-
s of very simple distributions in hierarchical structure can
produce a much more complicated distribution, e.g., a hi-
erarchical sparse prior [36], a zero-mean Gaussian distri-
bution with variance depicted by Gamma distribution [37],
and the super-Gaussian scale mixture model [22]. Thus the
two-level structure increase the possible solution spaces for
the proper and feasible prior to interpret Gaussian dropout.

37126

Secondly, the hierarchical structure enables the two-level
prior separable in the involved Bayesian inference and thus
is possible to simplify the Bayesian inference or makes the
intractable inference tractable, which will be further clari-
ï¬ed in the following subsections.

Similar to VD, the proposed VBD aims at optimizing a
variational posterior to approximate the true posterior [17,
23]. Unlike that VD only considers the posterior of network
weights, we propose to model the joint posterior of both the
network weights (e.g., W) and the hyper-parameters (e.g.,
ğ›¾) in their prior as illustrated in Figure 1. We thus arrive the
objective of Bayesian inference in the proposed VBD:

min
ğœƒ,ğ›¼,ğ›¾

ğ·ğ¾ğ¿(ğ‘(W, ğ›¾)âˆ£âˆ£ğ‘(W, ğ›¾âˆ£ğ’Ÿ)),

(9)

where ğ‘(W, ğ›¾) denotes a corresponding variational join-
t posterior for ğ‘(W, ğ›¾âˆ£ğ’Ÿ). Note that when the hyper-
parameter ğ›¾ is ï¬xed, the proposed VBD will reduce to VD.
Thus, the proposed VBD is a more general version of VD.
According to variational Bayesian inference technique [17],
we use the variational posterior ğ‘(W, ğ›¾) = ğ‘(W)ğ‘(ğ›¾) to
approximate the true posterior ğ‘(W, ğ›¾âˆ£ğ’Ÿ), and then the ob-
jective in Eq. (9) can be reformulated as the variational low-
er bound of the marginal likelihood of data as:

max
ğ›¼,ğœƒ,ğ›¾

ğ¿ğ’Ÿ(ğ›¼, ğœƒ)à¢¤ğ·ğ¾ğ¿(ğ‘(W)âˆ£âˆ£ğ‘(Wâˆ£ğ›¾))à¢¤ğ·ğ¾ğ¿(ğ‘(ğ›¾)âˆ£âˆ£ğ‘(ğ›¾)),

(10)
where ğ¿ğ’Ÿ is the expected log-likelihood term in Eq. (7).
Derivations can be found in supplementary material. For
the proposed VBD, the key is to exploit a proper hierarchi-
cal prior ğ‘(W, ğ›¾) for supporting Gaussian dropout. In the
following, we will provide such prior and discuss its advan-
tages.

3.4. The Proposed Hierarchical Prior

Inspired by the hierarchical prior in sparse Bayesian
learning [30], we assume the network weights W come
from a zero-mean Gaussian distribution. Then, a uniform
hyper-prior is imposed on the variance of the Gaussian dis-
tribution to adjust the shape of the ultimate prior. When
each element ğ‘Šğ‘˜,ğ‘‘ in W is independent identically dis-
tributed, the proposed two-level hierarchical prior ğ‘(W, ğ›¾)
is formulated as:

Proposition 2. With the prior ğ‘(ğ›¾) in Eq. (11), we em-
ploy mean-ï¬eld variational approximation, viz., ğ‘(ğ›¾) =
âˆğ¾
ğ‘‘=1 ğ‘(ğ›¾ğ‘˜,ğ‘‘), and assume that ğ‘(ğ›¾ğ‘˜,ğ‘‘) comes from
a delta distribution. Then the proposed VBD framework in
Eq. (10) reduces to

ğ‘˜=1 âˆğ·

max
ğ›¼,ğœƒ,ğ›¾

ğ¿ğ’Ÿ(ğ›¼, ğœƒ) à¢¤ ğ·ğ¾ğ¿(ğ‘(W)âˆ£âˆ£ğ‘(Wâˆ£ğ›¾)).

(12)

Given the prior in Eq. (11) and the variational posteri-
or ğ‘(ğ›¾ğ‘˜,ğ‘‘), ğ·ğ¾ğ¿(ğ‘(ğ›¾)âˆ£âˆ£ğ‘(ğ›¾)) in Eq. (10) will collapse to a
constant and thus can be neglected in optimization. Sim-
ilar trick can be found in [2, 1]. Speciï¬cally, to simplify
the representation, we assume ğ›¾ğ‘˜,ğ‘‘ as a one-dimensional s-
calar. As deï¬ned in Eq. (11), we have ğ‘(ğ›¾ğ‘˜,ğ‘‘) = 1/(ğ‘ à¢¤ ğ‘).
Note that the delta distribution ğ‘(ğ›¾ğ‘˜,ğ‘‘) either lies in or out of
[ğ‘, ğ‘], e.g., ğ›¿(ğ›¾ğ‘˜,ğ‘‘ à¢¤ ğ›¾â€²
ğ‘˜,ğ‘‘ lies in or out of [ğ‘, ğ‘]. If
ğ‘(ğ›¾ğ‘˜,ğ‘‘) is out of [ğ‘, ğ‘], there is ğ·ğ¾ğ¿(ğ‘(ğ›¾ğ‘˜,ğ‘‘)âˆ£âˆ£ğ‘(ğ›¾ğ‘˜,ğ‘‘)) =
+âˆ. To avoid this case, [ğ‘, ğ‘] is generally regarded as
a large enough interval [2, 1]. As a result, we arrive
ğ·ğ¾ğ¿(ğ‘(ğ›¾ğ‘˜,ğ‘‘)âˆ£âˆ£ğ‘(ğ›¾ğ‘˜,ğ‘‘)) = log(ğ‘ à¢¤ ğ‘), which is indepen-
dent to the unknown variables ğ›¼, ğœƒ and ğ›¾ and thus can be
neglected. Therefore, we do not need to set speciï¬c values
for the hyper-parameters ğ‘ and ğ‘ in practice. The detailed
proof can be found in supplementary material.

ğ‘˜,ğ‘‘) and ğ›¾â€²

According to [19], the key property of the log-uniform
prior is to enable the KL divergence ğ·ğ¾ğ¿(ğ‘(W)âˆ£âˆ£ğ‘(W))
in Eq. (7) not depending on weight parameters ğœƒ as men-
tioned in Proposition 1. With this property, learning ğœƒ in
VD will be consistent with that in conventional Gaussian
dropout for a ï¬xed dropout rate ğ›¼. In the following, we will
demonstrate that the proposed hierarchical prior Eq. (11) al-
so shows a similar property in VBD framework Eq. (12). To
this end, we give the following theoretical result.

Proposition 3. Given the objective Eq. (12), together with
the prior Eq. (11) and the variational posterior Eq. (4),
ğ·ğ¾ğ¿(ğ‘(W)âˆ£âˆ£ğ‘(Wâˆ£ğ›¾)) = âˆ‘ğ¾
ğ‘‘=1 0.5 log(1 + ğ›¼à¢¤1),
which does not depend on weight parameters ğœƒ.

ğ‘˜=1 âˆ‘ğ·

Proof. Since the variational posterior in Eq. (4) and the
prior ğ‘(Wâˆ£ğ›¾) in Eq. (11) are fully factorized, the KL-
divergence ğ·ğ¾ğ¿(ğ‘(W)âˆ£âˆ£ğ‘(Wâˆ£ğ›¾)) in (12) can be decom-
posed into a sum as:

ğ‘(Wâˆ£ğ›¾) =

ğ‘(ğ›¾) =

ğ¾

ğ·

âˆ

âˆ

ğ‘˜=1

ğ‘‘=1

ğ¾

ğ·

âˆ

âˆ

ğ‘˜=1

ğ‘‘=1

ğ‘(ğ‘Šğ‘˜,ğ‘‘âˆ£ğ›¾ğ‘˜,ğ‘‘) =

ğ¾

ğ·

âˆ

âˆ

ğ‘˜=1

ğ‘‘=1

ğ’© (ğ‘Šğ‘˜,ğ‘‘âˆ£0, ğ›¾ğ‘˜,ğ‘‘),

ğ¾

ğ·

âˆ‘

âˆ‘

ğ‘˜=1

ğ‘‘=1

ğ·ğ¾ğ¿(ğ‘(ğ‘Šğ‘˜,ğ‘‘)âˆ£âˆ£ğ‘(ğ‘Šğ‘˜,ğ‘‘âˆ£ğ›¾ğ‘˜,ğ‘‘)).

(13)

ğ‘(ğ›¾ğ‘˜,ğ‘‘) =

ğ¾

ğ·

âˆ

âˆ

ğ‘˜=1

ğ‘‘=1

ğ’° (ğ›¾ğ‘˜,ğ‘‘âˆ£ğ‘, ğ‘),

Since both the prior ğ‘(ğ‘Šğ‘˜,ğ‘‘) and the posterior ğ‘(ğ‘Šğ‘˜,ğ‘‘âˆ£ğ›¾ğ‘˜,ğ‘‘)
the KL divergence
follow Gaussian
ğ·ğ¾ğ¿(ğ‘(ğ‘Šğ‘˜,ğ‘‘)âˆ£âˆ£ğ‘(ğ‘Šğ‘˜,ğ‘‘âˆ£ğ›¾)) in Eq.
(13) can be calcu-
lated as:

distributions,

(11)

where ğ’° (ğ›¾ğ‘˜,ğ‘‘âˆ£ğ‘, ğ‘) denotes an uniform distribution with
range [ğ‘, ğ‘]. By imbedding this prior into the proposed VB-
D framework in Eq. (10), we give the following theoretical
result.

47127

ğ·ğ¾ğ¿(ğ‘(ğ‘Šğ‘˜,ğ‘‘)âˆ£âˆ£ğ‘(ğ‘Šğ‘˜,ğ‘‘âˆ£ğ›¾)) =
ğ›¼ğœƒ2

0.5 log(

) +

ğ›¾ğ‘˜,ğ‘‘
ğ›¼ğœƒ2

ğ‘˜,ğ‘‘

ğ‘˜,ğ‘‘ + ğœƒ2
2ğ›¾ğ‘˜,ğ‘‘

ğ‘˜,ğ‘‘

(14)

à¢¤ 0.5.

By introducing Eq. (14) into Eq. (12), we arrive:

max
ğ›¼,ğœƒ,ğ›¾

ğ¿ğ’Ÿ(ğ›¼, ğœƒ)âˆ’

ğ¾

ğ·

âˆ‘

âˆ‘

ğ‘˜=1

ğ‘‘=1

0.5 log(

ğ›¾ğ‘˜,ğ‘‘
ğ›¼ğœƒ2

ğ‘˜,ğ‘‘

) +

ğ›¼ğœƒ2

ğ‘˜,ğ‘‘ + ğœƒ2
2ğ›¾ğ‘˜,ğ‘‘

ğ‘˜,ğ‘‘

. (15)

To ï¬nd the optimal ğ›¾ğ‘˜,ğ‘‘, referred to as ğ›¾âˆ—
ğ‘˜,ğ‘‘, by setting the
partial differential of Eq. (15) with respect to ğ›¾ğ‘˜,ğ‘‘ to zero,
we have:

claims that the improper log-uniform prior interprets Gaus-
sian dropout, which fails to give full Bayesian interpretation
for Gaussian dropout and suffers limited regularization ca-
pacity, while VBD proposes a proper prior to handle those
drawbacks. In the following, we will show that these two
main differences further lead to the apparent advantage of
VBD in network compression compared with VD.

ğ›¾âˆ—
ğ‘˜,ğ‘‘ = ğ›¼ğœƒ2

ğ‘˜,ğ‘‘ + ğœƒ2

ğ‘˜,ğ‘‘.

(16)

4. Extension to Neural Network Compression

Replacing ğ›¾ğ‘˜,ğ‘‘ in Eq. (14) by Eq. (16) completes the proof.

In summary, with Propositions 2 and 3, the ï¬nal objec-
tive for the proposed VBD with the hierarchical prior can
be given as:

max
ğ›¼,ğœƒ

ğ¿ğ’Ÿ(ğ›¼, ğœƒ) à¢¤

ğ¾

ğ·

âˆ‘

âˆ‘

ğ‘˜=1

ğ‘‘=1

0.5 log(1 + ğ›¼à¢¤1).

(17)

Built on this loss function, we can see that: 1) The pro-
posed hierarchical prior also meets the requirement such
that ğ·ğ¾ğ¿(ğ‘(W)âˆ£âˆ£ğ‘(Wâˆ£ğ›¾)) does not depend on weight pa-
rameters ğœƒ.
In other words, the proposed VBD with the
hierarchical prior is consistent with Gaussian dropout when
ğ›¼ is ï¬xed. Hence, the proposed VBD can give Bayesian
interpretation for Gaussian dropout. 2) The dropout rate pa-
rameter ğ›¼ also can be automatically learned as VD.

Note that we apply a uniform prior on ğ›¾ to be able to
update ğ›¾. If ğ›¾ was treated as the variance hyper-parameter
of the Gaussian prior, we could not update it in the proposed
framework. This is because the prior could not see any data.
Then, if we cannot update ğ›¾, we cannot produce Eq. (16),
which means that we could not produce Propositions 3. To
allow ğ›¾ to be updated, we impose a uniform prior on it and
utilize delta variational posterior leading to Propositions 2.
This is also why many variational approximation methods
(e.g., [2, 1]) employ priors on hyper-parameters.

More importantly, the improper log-uniform prior in tra-
ditional VD induces ill-posed Bayesian inference, since
it leads to inï¬nite ğ·ğ¾ğ¿(ğ‘(W)âˆ£âˆ£ğ‘(W)) as mentioned in
[14, 15, 26]. By contrast, the proposed hierarchical pri-
or in VBD gives well-posed Bayesian inference, since it
produces reasonable and tractable ğ·ğ¾ğ¿(ğ‘(W)âˆ£âˆ£ğ‘(Wâˆ£ğ›¾))
as shown in Proposition 3. Hence, the proposed hierar-
chical prior in VBD shows obvious superiority over the
log-uniform prior in VD, and we argue that the proposed
VBD framework with the hierarchical prior provides a full
Bayesian interpretation for the success of Gaussian dropout
in preventing over-ï¬tting.

According to the discussion above, we can conclude as
follows. 1) The proposed VBD is a more general VBD.
VD focuses on incorporating one-level priors, while VBD
can contain two-level priors as shown in Figure 1. 2) VD

Since VD can adaptively learn the dropout rate ğ‘ (or ğ›¼)
from training dataset, it can be utilized for neural network-
s compression [25, 26]. Inspired by this, in this section we
turn to exploit the ability to apply the proposed VBD to neu-
ral networks compression under the frameworks proposed
in [25, 26]. In addition, we will also discuss the advantage
of the proposed framework on networks compression.

4.1. Compressing Weights

We ï¬rst extend the proposed VBD to compressing
weights under the framework in [25]. Further details about
the framework can be found in that paper. To this end,
the proposed hierarchical prior Eq. (11) is used to model
weights in a neural network. For convenience, we replace
the original ğ›¼ in Eq. (4) to learn speciï¬c ğ›¼ for each weight,
in which Proposition 3 holds. The distribution Eq. (4) as a
variational posterior, ğ’© (ğœƒğ‘˜,ğ‘‘, ğ›¼ğ‘˜,ğ‘‘ğœƒ2
ğ‘˜,ğ‘‘), is used to approxi-
mate the true posterior. In this way, to learn ğœƒğ‘˜,ğ‘‘ and ğ›¼ğ‘˜,ğ‘‘,
the objective function in Eq. (17) is rewritten as:

max
ğ›¼,ğœƒ

ğ¾

ğ·

ğ¿ğ’Ÿ(ğ›¼, ğœƒ) à¢¤

âˆ‘

âˆ‘

0.5 log(1 + ğ›¼à¢¤1

ğ‘˜,ğ‘‘).

(18)

ğ‘˜=1

ğ‘‘=1

Furthermore, since the natural gradient of ğœƒğ‘˜,ğ‘‘ faces with
high variance, we follow the re-parameterization trick in
[25], viz, ğœ2

ğ‘˜,ğ‘‘ = ğ›¼ğ‘˜,ğ‘‘ğœƒ2
difference
the method

ğ‘˜,ğ‘‘.
between
in

It

is

to

the

The

[25]

while

the
is

âˆ‘ğ¾

proposed

ğ‘˜=1 âˆ‘ğ·
VBD,

term à¢¤ğ·ğ¾ğ¿(ğ‘(W)âˆ£âˆ£ğ‘(W)).

proposed method
regular-
on
e-
ğ‘‘=1 à¢¤0.5 log(1 + ğ›¼à¢¤1
ğ‘˜,ğ‘‘)
is

it
ğ‘‘=1 ğ‘˜1ğ‘†(ğ‘˜2 + ğ‘˜3 log(ğ›¼ğ‘˜,ğ‘‘)) âˆ’ 0.5 log(1 + ğ›¼à¢¤1
ğ‘˜,ğ‘‘)

and
ization
quivalent
the
in
âˆ‘ğ¾
ğ‘˜=1 âˆ‘ğ·
in the method proposed in [25], where ğ‘˜1, ğ‘˜2 and ğ‘˜3 are
constant, and ğ‘†() denotes the sigmoid function. The
term à¢¤0.5 log(1 + ğ›¼à¢¤1
ğ‘˜,ğ‘‘) in the latter is heuristically
designed in [25] to model the behaviour that the negative
KL-divergence goes to a constant as log ğ›¼ğ‘˜,ğ‘‘ goes to
In contrast, the term à¢¤0.5 log(1 + ğ›¼à¢¤1
ğ‘˜,ğ‘‘)
minus inï¬nity.
in the proposed VBD is naturally derived from Bayesian
inference as mentioned above. Further discussion on this
term will be given in section 4.3.

57128

4.2. Structured Compressing

Although the method in [25] can be employed to com-
press weights in a neural network, it fails to accelerate neu-
ral networks in the testing phase, since resultant compres-
sion is unstructured. Recently, structured Bayesian pruning
in [26] employs VD to remove neurons and/or convolution-
al channels in convolutional neural networks for structured
compression, resulting in satisfactory performance. Similar
to VD, the proposed VBD also can be employed for struc-
tured pruning by constructing a dropout-like layer under the
framework in [26].

Speciï¬cally, we construct a single dropout-like layer

with an input matrix ğ‘“ (B) as follows:

Bâ€² = ğ‘“ (B) âˆ˜ Wâ€²,

(19)

where Wâ€² denotes the dropout noise and ğ‘“ () denotes the
activation function. The output of this layer Bâ€² is of the
same size as the input B, and would serve as an input
matrix for the following layer. Similar to that in the pre-
vious section, we enforce the proposed hierarchical pri-
or Eq. (11) on Wâ€², and imposes the variational posteri-
or, ğ’© (ğœƒğ‘š,ğ‘‘, ğ›¼ğ‘š,ğ‘‘ğœƒ2
ğ‘š,ğ‘‘) (For convenience, we re-utilize the
same symbol ğ›¼ğ‘š,ğ‘‘ and ğœƒğ‘š,ğ‘‘ that is originally used to mod-
el weights in the previous section, however, they are served
to Wâ€² in this section). Again, the objective function E-
q. (18) is used for learning ğœƒğ‘š,ğ‘‘ and ğ›¼ğ‘š,ğ‘‘, and the re-
parameterization [25] is adopted.

4.3. Analysis

In these two kinds of compression schemes above, ef-
fective compression depends on high dropout rate, e.g.,
ğ›¼ğ‘˜,ğ‘‘ â†’ âˆ or ğ›¼à¢¤1
ğ‘˜,ğ‘‘ â†’ 0, which corresponds to a bina-
ry dropout rate that approaches ğ‘ = 1. This effectively
means that the corresponding weight or neuron is always ig-
nored and can be removed [25]. In this subsection, we will
show that the proposed variational Bayesian dropout explic-
itly imposes a sparse regularization for optimizing ğ›¼à¢¤1
ğ‘˜,ğ‘‘, and
thus is able to effectively compress the deep neural network-
s. To this end, we ï¬rstly rewrite the objective Eq. (18) as:

min
ğ›¼,ğœƒ

ğ¾

ğ·

âˆ‘

âˆ‘

ğ‘˜=1

ğ‘‘=1

0.5 log(1 + ğ›¼à¢¤1

ğ‘˜,ğ‘‘) à¢¤ ğ¿ğ’Ÿ(ğ›¼, ğœƒ).

(20)

The expected log-likelihood term ğ¿ğ’Ÿ can be viewed as the
data ï¬t-term for ğ›¼à¢¤1
ğ‘˜,ğ‘‘ and the remainder derived from KL
divergence works as the regularization term. For such a reg-
ularization term, we have the following theoretical results.

Proposition 4. The regularization term 0.5 log(1 + ğ›¼à¢¤1
ğ‘˜,ğ‘‘)
in Eq. (20) is a concave, non-decreasing function on the
domain [0, +âˆ), with respect to ğ›¼à¢¤1
ğ‘˜,ğ‘‘.

According to [3], introducing such a regularization term
0.5 log(1 + ğ›¼à¢¤1
ğ‘˜,ğ‘‘) into the objective is beneï¬cial to promote

the sparsity of the solution. Therefore, with optimizing
ğ›¼à¢¤1
ğ‘˜,ğ‘‘, we can obtain sparse ğ›¼à¢¤1
ğ‘˜,ğ‘‘. Note that this regulariza-
tion term coincides with that in [5] which is motivated by
information bottleneck principle. In contrast, the regular-
ization term in this study stems from variational Bayesian
inference. Besides, this sparsity-promoting regularization
comes from a result of the particular variational approxima-
tion, which is different from previous methods with sparse
priors to compress network, e.g., [24, 7].

5. Experiments

In this section, we conduct experiments on classiï¬cation
task to demonstrate the effectiveness of the proposed vari-
ational Bayesian dropout in preventing over-ï¬tting. Then,
we further evaluate its performance in neural network com-
pression including weight compression and structured com-
pression. Note that neural network compression can also
imply the ability of preventing over-ï¬tting in term of the
ï¬nal test error.

5.1. Classiï¬cation

MNIST Dataset Following the settings in [19], we ï¬rst
take the hand-written digit classiï¬cation task on MNIST
dataset as a standard benchmark to evaluate the perfor-
mance of dropout methods in preventing over-ï¬tting. On
this task, we compare the proposed variational Bayesian
dropout with other ï¬ve existing dropout methods, name-
ly no dropout, standard dropout with Bernoulli noise [13],
dropout with Gaussian noise [29], Gaussian dropout [33]
and VD [19], and concrete dropout [6] which is able to learn
adaptive dropout rate. We follow the network architecture
in [29], which adopt a fully connected neural network con-
sisting of 3 hidden layers with different number of units and
rectiï¬ed linear units. For experimental setting, all networks
are trained for 50 epochs. More details about the network
architecture can be found in supplementary material.

The number of units

No Dropout

Dropout, Bernoulli
Dropout, Gaussian
Gaussian Dropout
Concrete Dropout

VD
Ours

100

1.80
1.69
1.70
1.66
2.39
1.69
1.56

340

1.77
1.68
1.66
1.64
1.61
1.62
1.53

580

1.78
1.67
1.68
1.71
1.55
1.67
1.53

820

1.78
1.67
1.69
1.65
1.54
1.62
1.52

1060

1.71
1.63
1.62
1.64
1.51
1.63
1.45

Table 1: Test error (%) on the MNIST dataset.

Table 1 shows the test error for all methods with various
choices of the number of units per layer. We observe that
although VD can adaptively learn dropout rate during train-
ing, it only obtains slightly better performance compared
with conventional dropout methods with ï¬xed dropout rate,

67129

including dropout with Bernoulli noise and dropout with
Gaussian noise. This is because the Bayesian inference in
VD with the improper log-uniform prior is ill-posed, which
hence ultimately restricts the capacity in preventing over-
ï¬tting as discussed before. Conversely, the proposed VBD
with adaptive dropout rate gains impressive performance,
which is better than that of the standard dropout as well as
VD. This proï¬ts from that the proposed hierarchical prior
is a proper prior and thus it can appropriately regularize the
network weights in the Bayesian inference. Besides, the
proposed VBD is superior to concrete dropout.

CIFAR-10 Dataset We further compare the proposed
method with dropout with Bernoulli noise [13], dropout
with Gaussian noise [29], VD [19], concrete dropout [6]
on CIFAR-10 dataset. We also compare with adversarial
dropout recently proposed in [27]. In this case, we follow
the network architecture with different ğ‘ ğ‘ğ‘ğ‘™ğ‘’ in [19] for ex-
perimental setting, all networks are trained for 100 epochs.
More details for the network architecture can be found in
supplementary material.

ğ‘ ğ‘ğ‘ğ‘™ğ‘’

No Dropout

Dropout, Bernoulli
Dropout, Gaussian
Adversarial Dropout

Concrete Dropout

VD
Ours

1

48.34
45.55
46.52
45.50
43.47
44.12
39.50

1.5

48.13
43.38
43.50
42.35
42.68
42.99
38.88

2

47.56
42.69
42.79
42.50
42.19
42.60
38.52

Table 2: Test error (%) on the CIFAR-10 dataset.

Figure 2 shows the test error for the all methods with
different ğ‘ ğ‘ğ‘ğ‘™ğ‘’. We can see that concrete dropout only per-
forms on par with traditional dropout methods and VD. In
addition, we found that due to its negative effect of the im-
proper log-uniform prior, VD only provides comparable re-
sults to those methods with ï¬xed dropout rate. In contrast,
proï¬ting from the proper hierarchical prior, the proposed
variational Bayesian dropout performs impressively well in
preventing over-ï¬tting. For example, when ğ‘ ğ‘ğ‘ğ‘™ğ‘’ = 2,
compared with no dropout method, the proposed method
reduces the test error by 9.04%. The improvement is even
up to 4.08% when compared with VD.

SVHN Dataset In this case, we follow the network ar-
chitecture with ğ‘ ğ‘ğ‘ğ‘™ğ‘’ = 1 used in experiments on CIFAR-
10 Dataset, and all networks are trained for 100 epochs Ta-
ble 3 shows the results of test error (%) in SVHN dataset.
Since traditional methods for setting dropout rate, such as
Grid-search based methods, are computationally expensive.
We set the dropout rate to be 0.5 for all layers of the net-
work in our experiments for simplicity. Under this simple
setting, traditional dropouts, e.g., Dropout with Bernoulli

Methods

Error (%)

No dropout

Dropout, Bernoulli
Dropout, Gaussian
Concrete Dropout

Adversarial Dropout

VD
Ours

22.01
20.31
20.22
18.95
18.66
19.74
17.46

Table 3: Test error on the SVHN dataset.

noise and Dropout with Gaussian noise, are slightly superi-
or to no dropout. Again, due to the improper log-uniform
prior, VD only provides comparable results to tradition-
al dropout with ï¬xed dropout rate. Conversely, compared
with these ï¬xed dropout rate based methods, the proposed
method with adaptive dropout rate gets the best test error,
17.46%.

5.2. Network compression

Compressing Weights In this part, we turn to evaluate
the effectiveness of the proposed method in weight com-
pression in neural networks for classiï¬cation on the MNIST
dataset. Here we adopt two kinds of basic neural networks,
the fully-connected LeNet-300-100 [21] and a convolution-
al LeNet-5-Caffe 1. We compare the proposed method with
four network compression methods, including Pruning [11],
Dynamic Network Surgery (DNS) [10], Soft Weight Shar-
ing (SWS) [32] and VD [25]. In the experiments, we strictly
follow the settings in [25].

Table 4 shows the results of compressing weights in
LeNet-300-100. Compared with traditional VD, with the
similar sparsity âˆ£Wâˆ£
âˆ£Wâˆ•=0âˆ£ = 66, the proposed method gets
1.67% test error that is better than the result of tradition-
al VD 1.94%. Further, although traditional VD has better
results in compression ratio âˆ£Wâˆ£
âˆ£Wâˆ•=0âˆ£ = 68, compared with
Pruning, DNS and SWS, it also reports higher test error
1.94% due to its limited ability to avoid over-ï¬tting. On the
contrary, since the proposed VBD provides a real Bayesian
interpretation for dropout, it can effectively prevent over-
ï¬tting and gains the better test error 1.76% as well as higher
compression ratio âˆ£Wâˆ£

âˆ£Wâˆ•=0âˆ£ = 81.

Table 4 also shows the results of compressing weights
in LeNet-5-Caffe. We can see that compared with Pruning,
DNS and SWS, traditional VD reports better compression
ratio âˆ£Wâˆ£
âˆ£Wâˆ•=0âˆ£ = 280 and test error 0.75%. Further, compared
with the all methods, the proposed method obtains the best
compression ratio âˆ£Wâˆ£

âˆ£Wâˆ•=0âˆ£ , without the loss of test error.

Structured Compressing We here test the performances
of the proposed method on structured compressing for neu-

1https://github.com/BVLC/caffe/tree/master/examples/mnist

77130

Methods

Original
Pruning

DNS
SWS
VD

Ours (low test error)
Ours (high sparsity)

LeNet-300-100

LeNet-5-Caffe

Error % Sparsity per Layer %

âˆ£Wâˆ£

âˆ£Wâˆ•=0âˆ£

Error % Sparsity per Layer %

1.64
1.59
1.99
1.94
1.94
1.67
1.76

92.0-91.0-74.0
98.2-98.2-94.5

98.9-97.2-62.0
98.7-97.4-87.4
98.9-98.1-90.9

1
12
56
23
68
66
81

0.8
0.77
0.91
0.97
0.75
0.74
0.81

34-88-92.0-81
86-97-99.3-96

67-98-99.8-95
69-98-99.7-95
65-98-99.8-97

âˆ£Wâˆ£

âˆ£Wâˆ•=0âˆ£

1
12
111
200
280
198
290

Table 4: Compressing weights in LeNet-300-100 and LeNet-5-Caffe. âˆ£Wâˆ£ and âˆ£Wâˆ•=0âˆ£ denote the number of weights, the
number of weights with nonzero value, respectively. The sparsity per layer is computed by the rate between the number of
weights with zero value and the number of weights in each layer.

ral networks. The used architecture of neural networks is a
fully-connected LeNet-500-300 and a convolutional LeNet-
5-Caffe. We compare VD [25], SSL [34] and SBP [26].

Table 5: Compressing neurons.

Models

Methods

Error %

Neurons per Layer

LeNet-500-300

LeNet-5-Caffe

Original

VD
SSL
SBP
Ours

Original

VD
SSL
SBP
Ours

1.54
1.57
1.49
1.55
1.35

0.80
0.75
1.00
0.86
0.66

784 - 500 - 300 - 10
537 - 217 - 130 - 10
434 - 174 - 78 - 10
245 - 160 - 55 - 10
179 - 160 - 60 - 10

20 - 50 - 800 - 500
17 - 32 - 329 - 75
3 - 12 - 800 - 500
3 - 18 - 284 - 283
16 - 34 - 123 - 62

Table 5 shows the results of compressing neurons in
LeNet-500-300. As discussed in [31, 14], VD based S-
BP corresponds to maximum likelihood estimation, which
leads to overly pruning neurons, and hence SBP gets the
higher test error 1.55%. The proposed method not only
prunes the most neurons but also gains the lowest test er-
ror. By contrast, due to the improper log-uniform prior, VD
produces the highest test error and only slightly compresses
neurons.

Table 5 also shows the results of neurons compression in
LeNet-5-Caffe for all methods. We ï¬nd that the proposed
method gains the lowest test error as well as the least neu-
rons, e.g., the test error of the proposed method is even up
to 0.66%. In addition, in LeNet-5-Caffe, the ï¬rst two layers
are convolutional layers, and the following two layers are
fully-connected layers. Differing from SSL and SBP that
mainly focus on pruning neurons in convolutional layers,
the result shows that the proposed method prefers to prun-
ing neurons in the fully-connected layers. This means that
the proposed method emphasizes feature extraction.

6. Conclusion

In this study, we propose a new generalization (i.e., VB-
D) for Gaussian dropout to address the drawback of VD
brought by the improper log-uniform prior, e.g., the ill-
posed inference of posterior over network weights. To-
wards this goal, we exploit a hierarchical prior to the net-
work weights and propose to infer the joint posterior over
both these weights and the hyper-parameters deï¬ned in their
ï¬rst-level prior. Through implementing the hierarchical pri-
or as a zero-mean Gaussian distribution with variance sam-
pled from a uniform hyper-prior, the proposed VDB can
cast the network training and the dropout rate estimation
into a joint optimization problem. In VBD, the hierarchi-
cal prior is a proper prior which enables the inference of
posterior to be well-posed, thus not only leading to a ful-
l Bayesian justiï¬cation for Gaussian dropout but also im-
proving regularization capacity. In addition, we also show
that the proposed VBD can be seamlessly applied to net-
work compression. In the experiments on both classiï¬ca-
tion and network compression tasks, the proposed VBD
shows superior performance in terms of regularizing net-
work training.

VBD is a general dropout framework, which exploits a
promising direction for dropout, i.e., investigating hierar-
chical priors of network weights. The Gaussian-uniform
prior in this study is one feasible choice, but no means the
only option. In the future, more effort will be made to ex-
ploit other possible choices to regularize the training pro-
cess of deep neural networks better.

Acknowledgements: This work was partially support-
ed by National Key R&D Program of China (2018YF-
B0904200), National Natural Science Foundation of China
(No. 61672024, 61170305 and 60873114) and Australian
Research Council
(DP140102270 and DP160100703).
Yuhang was supported by a scholarship from the China
Scholarship Council.

87131

References

[1] S Derin Babacan, Rafael Molina, Minh N Do, and
Aggelos K Katsaggelos. Bayesian blind deconvolu-
tion with general sparse image priors.
In European
Conference on Computer Vision (ECCV), pages 341â€“
355. Springer, 2012. 4, 5

[2] Kwokleung Chan, Te-Won Lee, and Terrence J Se-
jnowski. Variational learning of clusters of undercom-
plete nonsymmetric independent components. Journal
of Machine Learning Research (JMLR), 3(Aug):99â€“
114, 2002. 4, 5

[3] Yichen Chen, Dongdong Ge, Mengdi Wang, Zizhuo
Wang, Yinyu Ye, and Hao Yin. Strong NP-hardness
for sparse optimization with concave penalty function-
s. In Proceedings of the 34th International Conference
on Machine Learning (ICML), pages 740â€“747, 2017.
6

[4] Ronan Collobert and Jason Weston. A uniï¬ed archi-
tecture for natural language processing: Deep neural
networks with multitask learning. In Proceedings of
the 25th international conference on Machine learn-
ing (ICML), pages 160â€“167, 2008. 1

[5] Bin Dai, Chen Zhu, Baining Guo, and David Wipf.
Compressing neural networks using the variational in-
formation bottleneck. In Proceedings of the 35th In-
ternational Conference on Machine Learning (ICML),
pages 1135â€“1144, 2018. 6

[6] Yarin Gal, Jiri Hron, and Alex Kendall. Concrete
dropout. In Advances in Neural Information Process-
ing Systems (NIPS), pages 3581â€“3590, 2017. 2, 6, 7

[7] Soumya Ghosh, Jiayu Yao, and Finale Doshi-Velez.
Structured variational learning of bayesian neural net-
works with horseshoe priors.
arXiv preprint arX-
iv:1806.05975, 2018. 6

[8] Dong Gong, Jie Yang, Lingqiao Liu, Yanning Zhang,
Ian Reid, Chunhua Shen, Anton Van Den Hengel, and
Qinfeng Shi. From motion blur to motion ï¬‚ow: a deep
learning solution for removing heterogeneous motion
blur. In Proceedings of the IEEE Conference on Com-
puter Vision and Pattern Recognition (CVPR), pages
2319â€“2328, 2017. 1

[9] Ian Goodfellow, Yoshua Bengio, Aaron Courville, and
Yoshua Bengio. Deep learning, volume 1. MIT press
Cambridge, 2016. 1

[10] Yiwen Guo, Anbang Yao, and Yurong Chen. Dynam-
ic network surgery for efï¬cient dnns. In Advances In
Neural Information Processing Systems (NIPS), pages
1379â€“1387, 2016. 7

[11] Song Han, Jeff Pool, John Tran, and William Dally.
Learning both weights and connections for efï¬cien-
t neural network. In Advances in Neural Information

Processing Systems (NIPS), pages 1135â€“1143, 2015.
7

[12] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian
Sun. Deep residual learning for image recognition. In
Proceedings of the IEEE conference on computer vi-
sion and pattern recognition (CVPR), pages 770â€“778,
2016. 1

[13] Geoffrey E Hinton, Nitish Srivastava, Alex
Krizhevsky, Ilya Sutskever, and Ruslan R Salakhut-
Improving neural networks by preventing
dinov.
co-adaptation of feature detectors.
arXiv preprint
arXiv:1207.0580, 2012. 1, 2, 3, 6, 7

[14] Jiri Hron, Alexander GG Matthews, and Zoubin
Ghahramani. Variational bayesian dropout: pitfall-
s and ï¬xes.
In Proceedings of the 35th Internation-
al Conference on Machine Learning (ICML), pages
2024â€“2033, 2018. 2, 3, 5, 8

[15] Jiri Hron, Alexander G de G Matthews, and Zoubin
Ghahramani. Variational gaussian dropout is not
bayesian. arXiv preprint arXiv:1711.02989, 2017. 2,
3, 5

[16] G. Huang, Z. Liu, L. v. d. Maaten, and K. Q. Wein-
berger. Densely connected convolutional networks.
In Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition (CVPR), pages 2261â€“
2269, 2017. 1

[17] Michael I Jordan, Zoubin Ghahramani, Tommi S
Jaakkola, and Lawrence K Saul. An introduction to
variational methods for graphical models. Machine
learning, 37(2):183â€“233, 1999. 4

[18] Alex Kendall, Vijay Badrinarayanan, and Roberto
Cipolla. Bayesian segnet: Model uncertainty in deep
convolutional encoder-decoder architectures for scene
understanding.
arXiv preprint arXiv:1511.02680,
2015. 1

[19] Diederik P Kingma, Tim Salimans, and Max Welling.
Variational dropout and the local reparameterization
trick. In Advances in Neural Information Processing
Systems (NIPS), pages 2575â€“2583, 2015. 1, 2, 3, 4, 6,
7

[20] Alex Krizhevsky, Ilya Sutskever, and Geoffrey E Hin-
ton. Imagenet classiï¬cation with deep convolutional
neural networks. In Advances in Neural Information
Processing Systems (NIPS), pages 1097â€“1105, 2012.
1

[21] Yann LeCun, LÂ´eon Bottou, Yoshua Bengio, and
Patrick Haffner. Gradient-based learning applied to
document recognition.
Proceedings of the IEEE,
86(11):2278â€“2324, 1998. 7

[22] Yuhang Liu, Wenyong Dong, Dong Gong, Lei Zhang,
and Qinfeng Shi. Deblurring natural image using

97132

[35] Chiyuan Zhang, Samy Bengio, Moritz Hardt, Ben-
jamin Recht, and Oriol Vinyals. Understanding deep
learning requires rethinking generalization.
arXiv
preprint arXiv:1611.03530, 2016. 1

[36] Lei Zhang, Wei Wei, Yanning Zhang, Chunhua Shen,
Anton van den Hengel, and Qinfeng Shi. Cluster s-
parsity ï¬eld: An internal hyperspectral imagery prior
for reconstruction. International Journal of Computer
Vision (IJCV), 126(8):797â€“821, 2018. 3

[37] Lei Zhang, Wei Wei, Yanning Zhang, Chunna Tian,
and Fei Li. Reweighted laplace prior based hyperspec-
tral compressive sensing for unknown sparsity. In Pro-
ceedings of the IEEE Conference on Computer Vision
and Pattern Recognition (CVPR), pages 2274â€“2281,
2015. 3

super-gaussian ï¬elds. In Proceedings of the European
Conference on Computer Vision (ECCV), pages 452â€“
468, 2018. 3

[23] Yuhang Liu, Wenyong Dong, and Mengchu Zhou.
Frame-based variational bayesian learning for inde-
pendent or dependent source separation. IEEE Trans-
actions on Neural Networks and Learning Systems
(TNNLS), 29(10):4983â€“4996, 2018. 4

[24] Christos Louizos, Karen Ullrich, and Max Welling.
Bayesian compression for deep learning. In Advances
in Neural Information Processing Systems (NIPS),
pages 3288â€“3298, 2017. 6

[25] Dmitry Molchanov, Arsenii Ashukha, and Dmitry
Vetrov. Variational dropout sparsiï¬es deep neural net-
works. In Proceedings of the 34th International Con-
ference on Machine Learning (ICML), pages 2498â€“
2507, 2017. 2, 5, 6, 7, 8

[26] Kirill Neklyudov, Dmitry Molchanov, Arsenii
Ashukha, and Dmitry P Vetrov. Structured bayesian
pruning via log-normal multiplicative noise.
In
Advances in Neural Information Processing Systems
(NIPS), pages 6775â€“6784, 2017. 2, 3, 5, 6, 8

[27] Sungrae Park, JunKeon Park, Su-Jin Shin, and Il-Chul
Moon. Adversarial dropout for supervised and semi-
supervised learning. In AAAI Conference on Artiï¬cial
Intelligence (AAAI), 2018. 2, 7

[28] Karen Simonyan and Andrew Zisserman. Very deep
convolutional networks for large-scale image recogni-
tion. arXiv preprint arXiv:1409.1556, 2014. 1

[29] Nitish Srivastava, Geoffrey Hinton, Alex Krizhevsky,
Ilya Sutskever, and Ruslan Salakhutdinov. Dropout:
a simple way to prevent neural networks from overï¬t-
ting. Journal of Machine Learning Research (JMLR),
15(1):1929â€“1958, 2014. 1, 2, 3, 6, 7

[30] Michael E Tipping. Sparse bayesian learning and the
relevance vector machine. Journal of machine learn-
ing research (JMLR), 1(Jun):211â€“244, 2001. 4

[31] Brian Trippe and Richard Turner. Overpruning in vari-
ational bayesian neural networks. arXiv preprint arX-
iv:1801.06230, 2018. 8

[32] Karen Ullrich, Edward Meeds, and Max Welling. Soft
weight-sharing for neural network compression. arXiv
preprint arXiv:1702.04008, 2017. 7

[33] Sida Wang and Christopher Manning. Fast dropout
training.
In Proceedings of the 30th International
Conference on Machine Learning (ICML), pages 118â€“
126, 2013. 1, 2, 6

[34] Wei Wen, Chunpeng Wu, Yandan Wang, Yiran Chen,
and Hai Li. Learning structured sparsity in deep neu-
ral networks. In Advances in Neural Information Pro-
cessing Systems (NIPS), pages 2074â€“2082, 2016. 8

107133

